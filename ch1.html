<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R Code for ‘A Practical Guide . . .’ - 1&nbsp; Chapter 1: Learning from data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch2.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-code-and-supplements" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Code and Supplements</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-code-and-supplements">    
        <li>
    <a class="dropdown-item" href="https://ten-z.github.io/SupplementsTest/">
 <span class="dropdown-text">Supplements</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://jhmaindonald.github.io/PGRselected/">
 <span class="dropdown-text">Answers to selected exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://ten-z.github.io/SupplementsTest/afterword.html">
 <span class="dropdown-text">Afterword</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://ten-z.github.io/SupplementsTest/about.html"> 
<span class="menu-text">Practical Guide</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://ten-z.github.io/SupplementsTest/blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">R code</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="https://ten-z.github.io/SupplementsTest/RunningCode.html">
 <span class="dropdown-text">Ways to Use Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://ten-z.github.io/SupplementsTest/figFuns.html">
 <span class="dropdown-text">Code for Selected Figures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://ten-z.github.io/PGRTestBook/R-Code-for--A-Practical-Guide-.-.-.-.pdf">
 <span class="dropdown-text">Download PDF</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://ten-z.github.io/PGRTestBook/R-Code-for--A-Practical-Guide-.-.-.-.docx">
 <span class="dropdown-text">Download Docx</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <a href="https://github.com/jhmaindonald/code/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="./R-Code-for--A-Practical-Guide-.-.-.-.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="./R-Code-for--A-Practical-Guide-.-.-.-.docx">
              <i class="bi bi-bi-file-word pe-1"></i>
            Download Docx
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch1.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Chapter 1: Learning from data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Chapter 1: Learning from data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Chapter 2: Generalizing from models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Chapter 3: Multiple linear regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Chapter 4: Exploiting the linear model framework</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Chapter 5: Generalized linear models and survival analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Chapter 9: Multivariate data exploration and discrimination</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Appendix A: The R System – A Brief Overview</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#section-1.1-questions-and-data-that-may-point-to-answers" id="toc-section-1.1-questions-and-data-that-may-point-to-answers" class="nav-link active" data-scroll-target="#section-1.1-questions-and-data-that-may-point-to-answers">Section 1.1: Questions, and data that may point to answers</a></li>
  <li><a href="#section-1.2-graphical-tools-for-data-exploration" id="toc-section-1.2-graphical-tools-for-data-exploration" class="nav-link" data-scroll-target="#section-1.2-graphical-tools-for-data-exploration">Section 1.2: Graphical tools for data exploration</a></li>
  <li><a href="#section-1.3-data-summary" id="toc-section-1.3-data-summary" class="nav-link" data-scroll-target="#section-1.3-data-summary">Section 1.3: Data Summary</a></li>
  <li><a href="#section-1.4-distributions-quantifying-uncertainty" id="toc-section-1.4-distributions-quantifying-uncertainty" class="nav-link" data-scroll-target="#section-1.4-distributions-quantifying-uncertainty">Section 1.4: Distributions: quantifying uncertainty</a></li>
  <li><a href="#section-1.5-simple-forms-of-regression-model" id="toc-section-1.5-simple-forms-of-regression-model" class="nav-link" data-scroll-target="#section-1.5-simple-forms-of-regression-model">Section 1.5: Simple forms of regression model</a></li>
  <li><a href="#section-1.6-data-based-judgments-frequentist-in-a-bayesian-world" id="toc-section-1.6-data-based-judgments-frequentist-in-a-bayesian-world" class="nav-link" data-scroll-target="#section-1.6-data-based-judgments-frequentist-in-a-bayesian-world">Section 1.6: Data-based judgments – frequentist, in a Bayesian world</a></li>
  <li><a href="#section-1.7-information-statistics-and-bayesian-methods-with-bayes-factors" id="toc-section-1.7-information-statistics-and-bayesian-methods-with-bayes-factors" class="nav-link" data-scroll-target="#section-1.7-information-statistics-and-bayesian-methods-with-bayes-factors">Section 1.7: Information statistics and Bayesian methods with Bayes Factors</a></li>
  <li><a href="#section-1.8-resampling-methods-for-ses-tests-and-confidence-intervals" id="toc-section-1.8-resampling-methods-for-ses-tests-and-confidence-intervals" class="nav-link" data-scroll-target="#section-1.8-resampling-methods-for-ses-tests-and-confidence-intervals">Section 1.8: Resampling methods for SEs, tests and confidence intervals</a></li>
  <li><a href="#section-1.9-organizing-and-managing-work-and-tools-that-can-assist" id="toc-section-1.9-organizing-and-managing-work-and-tools-that-can-assist" class="nav-link" data-scroll-target="#section-1.9-organizing-and-managing-work-and-tools-that-can-assist">Section 1.9: Organizing and managing work, and tools that can assist</a></li>
  <li><a href="#section-1.10-the-changing-environment-for-data-analysis" id="toc-section-1.10-the-changing-environment-for-data-analysis" class="nav-link" data-scroll-target="#section-1.10-the-changing-environment-for-data-analysis">Section 1.10: The changing environment for data analysis</a></li>
  <li><a href="#section-1.11-further-or-supplementary-reading" id="toc-section-1.11-further-or-supplementary-reading" class="nav-link" data-scroll-target="#section-1.11-further-or-supplementary-reading">Section 1.11: Further, or supplementary, reading</a></li>
  <li><a href="#exercises-1_12" id="toc-exercises-1_12" class="nav-link" data-scroll-target="#exercises-1_12">Exercises (1_12)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Chapter 1: Learning from data</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<div class="cell">
<style type="text/css">
.colbox {
  padding: 1em;
  background: white;
  color: black;
  border: 2px solid orange;
  border-radius: 10px;
}
.center {
  text-align: left;
}
}
</style>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>opts_chunk[[<span class="st">'set'</span>]](<span class="at">fig.width=</span><span class="dv">6</span>, <span class="at">fig.height=</span><span class="dv">6</span>, <span class="at">comment=</span><span class="st">" "</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">out.width=</span><span class="st">"80%"</span>, <span class="at">fig.align=</span><span class="st">"center"</span>, <span class="at">fig.show=</span><span class="st">'hold'</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size=</span><span class="st">"small"</span>, <span class="at">ps=</span><span class="dv">10</span>, <span class="at">strip.white =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">tidy.opts =</span> <span class="fu">list</span>(<span class="at">replace.assign=</span><span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## xtras=TRUE    ## Set to TRUE to execute code 'extras'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>xtras <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="do">## opts_chunk[['set']](results="asis")</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="do">## opts_chunk[['set']](eval=FALSE)   ## Set to TRUE to execute main part of code</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>opts_chunk[[<span class="st">'set'</span>]](<span class="at">eval=</span><span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="packages-required-plus-any-dependencies" class="level5">
<h5 class="anchored" data-anchor-id="packages-required-plus-any-dependencies">Packages required (plus any dependencies)</h5>
<p>latticeExtra (lattice is a dependency); DAAG; car; MASS; AICcmodavg; BayesFactor; boot; MPV; ggplot2; tidyr</p>
<p>Additionally, knitr and Hmisc are required in order to process the Rmd source file. The prettydoc package is by default used to format the html output.</p>
</section>
<section id="chapter-summary" class="level5">
<h5 class="anchored" data-anchor-id="chapter-summary">Chapter summary</h5>
</section>
<section id="a-note-on-terminology-variables-factors-and-more" class="level5">
<h5 class="anchored" data-anchor-id="a-note-on-terminology-variables-factors-and-more">A note on terminology — variables, factors, and more!</h5>
</section>
<section id="section-1.1-questions-and-data-that-may-point-to-answers" class="level3">
<h3 class="anchored" data-anchor-id="section-1.1-questions-and-data-that-may-point-to-answers">Section 1.1: Questions, and data that may point to answers</h3>
<section id="subsection-1.1.1-a-sample-is-a-window-into-the-wider-population" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.1.1-a-sample-is-a-window-into-the-wider-population">Subsection 1.1.1: A sample is a window into the wider population</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For the sequence below, precede with set.seed(3676)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3696</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9384</span>, <span class="dv">12</span>, <span class="at">replace=</span><span class="cn">FALSE</span>)  <span class="co"># NB: `replace=FALSE` is the default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>chosen1200 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">19384</span>, <span class="dv">1200</span>, <span class="at">replace=</span><span class="cn">FALSE</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For the sequence below, precede with set.seed(366)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">366</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">split</span>(<span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)), <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Control"</span>,<span class="st">"Treatment"</span>), <span class="dv">5</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sample(1:10) gives a random re-arrangement (permutation) of 1, 2, ..., 10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="cluster-sampling" class="level5">
<h5 class="anchored" data-anchor-id="cluster-sampling">Cluster sampling</h5>
</section>
<section id="a-note-on-with-replacement-samples" class="level5">
<h5 class="anchored" data-anchor-id="a-note-on-with-replacement-samples">*A note on with-replacement samples</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="do">## sample(1:10, replace=FALSE) returns a random permutation of 1,2,...10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="subsection-1.1.2-formulating-the-scientific-question" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.1.2-formulating-the-scientific-question">Subsection 1.1.2: Formulating the scientific question</h4>
<section id="example-a-question-about-cuckoo-eggs" class="level5">
<h5 class="anchored" data-anchor-id="example-a-question-about-cuckoo-eggs">Example: a question about cuckoo eggs</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latticeExtra)   <span class="co"># Lattice package will be loaded and attached also</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>cuckoos <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>cuckoos</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel A: Dotplot without species means added</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dotplot</span>(species <span class="sc">~</span> length, <span class="at">data=</span>cuckoos)   <span class="do">## `species ~ length` is a 'formula'</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel B: Box and whisker plot</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(species <span class="sc">~</span> length, <span class="at">data=</span>cuckoos)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="do">## The following shows Panel A, including species means &amp; other tweaks</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>av <span class="ot">&lt;-</span> <span class="fu">with</span>(cuckoos, <span class="fu">aggregate</span>(length, <span class="fu">list</span>(<span class="at">species=</span>species), <span class="at">FUN=</span>mean))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dotplot</span>(species <span class="sc">~</span> length, <span class="at">data=</span>cuckoos, <span class="at">alpha=</span><span class="fl">0.4</span>, <span class="at">xlab=</span><span class="st">"Length of egg (mm)"</span>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.layer</span>(<span class="fu">dotplot</span>(species <span class="sc">~</span> x, <span class="at">pch=</span><span class="dv">3</span>, <span class="at">cex=</span><span class="fl">1.4</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">data=</span>av))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use `+` to indicate that more (another 'layer') is to be added.</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># With `alpha=0.4`, 40% is the point color with 60% background color</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># `pch=3`: Plot character 3 is '+'; `cex=1.4`: Default char size X 1.4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Code</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(latticeExtra, <span class="at">quietly=</span><span class="cn">TRUE</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>cuckoos <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>cuckoos</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="do">## For tidier labels replace ".", in several of the names, by a space</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>specnam <span class="ot">&lt;-</span> <span class="fu">with</span>(cuckoos, <span class="fu">sub</span>(<span class="at">pattern=</span><span class="st">"."</span>, <span class="at">replacement=</span><span class="st">" "</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">levels</span>(species), <span class="at">fixed=</span><span class="cn">TRUE</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fixed=TRUE: "interpret "." as ".", not as a 'any single character'"</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>cuckoos <span class="ot">&lt;-</span> <span class="fu">within</span>(cuckoos, <span class="fu">levels</span>(species) <span class="ot">&lt;-</span> specnam)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel A: Dotplot: data frame cuckoos (DAAG)</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>av <span class="ot">&lt;-</span> <span class="fu">with</span>(cuckoos, <span class="fu">aggregate</span>(length, <span class="fu">list</span>(<span class="at">species=</span>species), <span class="at">FUN=</span>mean))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>gphA <span class="ot">&lt;-</span> <span class="fu">dotplot</span>(species <span class="sc">~</span> length, <span class="at">data=</span>cuckoos, <span class="at">alpha=</span><span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.layer</span>(<span class="fu">dotplot</span>(species <span class="sc">~</span> x, <span class="at">pch=</span><span class="dv">3</span>, <span class="at">cex=</span><span class="fl">1.4</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">data=</span>av))</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha sets opacity. With alpha=0.4, 60% of the background shows through</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Enter `print(plt1)` or `plot(plt1)` or simply `plt1` to display the graph</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel B: Box plot</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>gphB <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(species <span class="sc">~</span> length, <span class="at">data=</span>cuckoos)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(<span class="fu">c</span>(<span class="st">"A: Dotplot"</span><span class="ot">=</span>gphA, <span class="st">"B: Boxplot"</span><span class="ot">=</span>gphB), <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fl">0.4</span>),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">"Length of egg (mm)"</span>) </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="do">## latticeExtra::c() joins compatible plots together. </span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="do">##   See `?latticeExtra::c`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="subsection-1.1.3-planning-for-a-statistical-analysis" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.1.3-planning-for-a-statistical-analysis">Subsection 1.1.3: Planning for a statistical analysis</h4>
<section id="understand-the-data" class="level5">
<h5 class="anchored" data-anchor-id="understand-the-data">Understand the data</h5>
</section>
<section id="causal-inference" class="level5">
<h5 class="anchored" data-anchor-id="causal-inference">Causal inference</h5>
</section>
<section id="what-was-measured-is-it-the-relevant-measure" class="level5">
<h5 class="anchored" data-anchor-id="what-was-measured-is-it-the-relevant-measure">What was measured? Is it the relevant measure?</h5>
</section>
<section id="use-relevant-prior-information-in-the-planning-stages" class="level5">
<h5 class="anchored" data-anchor-id="use-relevant-prior-information-in-the-planning-stages">Use relevant prior information in the planning stages</h5>
</section>
<section id="subject-area-knowledge-and-judgments" class="level5">
<h5 class="anchored" data-anchor-id="subject-area-knowledge-and-judgments">Subject area knowledge and judgments</h5>
</section>
<section id="the-importance-of-clear-communication" class="level5">
<h5 class="anchored" data-anchor-id="the-importance-of-clear-communication">The importance of clear communication</h5>
</section>
<section id="data-based-selection-of-comparisons" class="level5">
<h5 class="anchored" data-anchor-id="data-based-selection-of-comparisons">Data-based selection of comparisons</h5>
</section>
<section id="models-must-be-fit-for-their-intended-use" class="level5">
<h5 class="anchored" data-anchor-id="models-must-be-fit-for-their-intended-use">Models must be fit for their intended use</h5>
</section>
</section>
<section id="subsection-1.1.4-results-that-withstand-thorough-and-informed-challenge" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.1.4-results-that-withstand-thorough-and-informed-challenge">Subsection 1.1.4: Results that withstand thorough and informed challenge</h4>
</section>
<section id="subsection-1.1.5-using-graphs-to-make-sense-of-data" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.1.5-using-graphs-to-make-sense-of-data">Subsection 1.1.5: Using graphs to make sense of data</h4>
<section id="graphical-comparisons" class="level5">
<h5 class="anchored" data-anchor-id="graphical-comparisons">Graphical comparisons</h5>
</section>
</section>
<section id="subsection-1.1.6-formal-model-based-comparison" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.1.6-formal-model-based-comparison">Subsection 1.1.6: Formal model-based comparison</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width=</span><span class="dv">70</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cuckoos <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>cuckoos</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>av <span class="ot">&lt;-</span> <span class="fu">with</span>(cuckoos, <span class="fu">aggregate</span>(length, <span class="fu">list</span>(<span class="at">species=</span>species), <span class="at">FUN=</span>mean))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">setNames</span>(<span class="fu">round</span>(av[[<span class="st">"x"</span>]],<span class="dv">2</span>), <span class="fu">abbreviate</span>(av[[<span class="st">"species"</span>]],<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(cuckoos, <span class="fu">scale</span>(length[species<span class="sc">==</span><span class="st">"wren"</span>], <span class="at">scale=</span><span class="cn">FALSE</span>))[,<span class="dv">1</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="section-1.2-graphical-tools-for-data-exploration" class="level3">
<h3 class="anchored" data-anchor-id="section-1.2-graphical-tools-for-data-exploration">Section 1.2: Graphical tools for data exploration</h3>
<section id="subsection-1.2.1-displays-of-a-single-variable" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.2.1-displays-of-a-single-variable">Subsection 1.2.1: Displays of a single variable</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latticeExtra, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fossum <span class="ot">&lt;-</span> <span class="fu">subset</span>(DAAG<span class="sc">::</span>possum, sex<span class="sc">==</span><span class="st">"f"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>femlen <span class="ot">&lt;-</span> DAAG<span class="sc">::</span><span class="fu">bounce</span>(fossum[[<span class="st">"totlngth"</span>]], <span class="at">d=</span><span class="fl">0.1</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel A</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>yaxpos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>)<span class="sc">/</span>(<span class="dv">5</span><span class="sc">*</span><span class="fu">nrow</span>(fossum))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(<span class="fu">list</span>(<span class="at">val =</span> femlen), <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>gph1 <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(<span class="sc">~</span>femlen, <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.55</span>,<span class="fl">2.75</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">70</span>,<span class="dv">100</span>), </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales=</span><span class="fu">list</span>(<span class="at">y=</span><span class="fu">list</span>(<span class="at">draw=</span><span class="cn">FALSE</span>)))<span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        latticeExtra<span class="sc">::</span><span class="fu">layer</span>(<span class="fu">panel.rug</span>(x,<span class="at">pch=</span><span class="st">"|"</span>))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>legstat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(z<span class="sc">$</span>out,z<span class="sc">$</span>stats), <span class="at">y=</span><span class="fu">c</span>(<span class="fl">1.08</span>, <span class="fu">rep</span>(<span class="fl">1.3</span>,<span class="dv">5</span>)),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">tx=</span><span class="fu">c</span>(<span class="st">"Outlier?"</span>, <span class="st">"Smallest value"</span>, <span class="st">"lower quartile"</span>, <span class="st">"median"</span>, </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>       <span class="st">"upper quartile"</span>,  <span class="st">"Largest value"</span>), </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">tx2=</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"(outliers excepted)"</span>,<span class="fu">rep</span>(<span class="st">""</span>,<span class="dv">3</span>), <span class="st">"(no outliers)"</span>))</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>gphA <span class="ot">&lt;-</span> gph1<span class="sc">+</span>latticeExtra<span class="sc">::</span><span class="fu">layer</span>(<span class="at">data=</span>legstat,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel.text</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">labels=</span>tx,<span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>),<span class="at">srt=</span><span class="dv">90</span>, <span class="at">cex=</span><span class="fl">0.85</span>),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel.text</span>(<span class="at">x=</span>x[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>)]<span class="sc">+</span><span class="fl">0.75</span>,<span class="at">y=</span><span class="fu">c</span>(<span class="fl">1.125</span>,<span class="fl">1.38</span>),<span class="at">labels=</span>tx2[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>)],</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>),<span class="at">srt=</span><span class="dv">90</span>, <span class="at">cex=</span><span class="fl">0.85</span>))</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel B</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>gph2 <span class="ot">&lt;-</span> <span class="fu">densityplot</span>(<span class="sc">~</span>femlen, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.108</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">70</span>,<span class="dv">100</span>), </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.points=</span><span class="cn">TRUE</span>, <span class="at">pch=</span><span class="st">"|"</span>,<span class="at">cex=</span><span class="fl">1.75</span>, <span class="at">ylab=</span><span class="fu">c</span>(<span class="st">""</span>,<span class="st">"      Density"</span>))</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>gph3 <span class="ot">&lt;-</span> <span class="fu">histogram</span>(<span class="sc">~</span>femlen, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.108</span>), <span class="at">type=</span><span class="st">"density"</span>, </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">scales=</span><span class="fu">list</span>(<span class="at">y=</span><span class="fu">list</span>(<span class="at">at=</span>yaxpos, <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>), <span class="at">col=</span><span class="st">"gray40"</span>)), </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">75</span>,<span class="dv">80</span>,<span class="dv">85</span>,<span class="dv">90</span>,<span class="dv">95</span>,<span class="dv">100</span>), </span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="st">'transparent'</span>,<span class="at">border=</span><span class="st">'gray40'</span>)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>gph4 <span class="ot">&lt;-</span> <span class="fu">doubleYScale</span>(gph2, gph3, <span class="at">use.style=</span><span class="cn">FALSE</span>, <span class="at">add.ylab2=</span><span class="cn">FALSE</span>)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>gphB <span class="ot">&lt;-</span> <span class="fu">update</span>(gph4, <span class="at">par.settings=</span><span class="fu">list</span>(<span class="at">fontsize =</span> <span class="fu">list</span>(<span class="at">text=</span><span class="dv">10</span>, <span class="at">points=</span><span class="dv">5</span>)),</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">scales=</span><span class="fu">list</span>(<span class="at">tck=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>)))</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(<span class="fu">c</span>(<span class="st">"B: Density curve, with histogram overlaid"</span><span class="ot">=</span>gphB, </span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>         <span class="st">"A: Boxplot, with annotation added"</span><span class="ot">=</span>gphA, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">y.same=</span>F), </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">as.table=</span><span class="cn">TRUE</span>, <span class="at">between=</span><span class="fu">list</span>(<span class="at">y=</span><span class="fl">1.4</span>), </span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">"Total length of female possums (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fossum <span class="ot">&lt;-</span> <span class="fu">subset</span>(DAAG<span class="sc">::</span>possum, sex<span class="sc">==</span><span class="st">"f"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(<span class="sc">~</span>totlngth, <span class="at">plot.points=</span><span class="cn">TRUE</span>, <span class="at">pch=</span><span class="st">"|"</span>, <span class="at">data=</span>fossum) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layer_</span>(<span class="fu">panel.histogram</span>(x, <span class="at">type=</span><span class="st">"density"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">75</span>,<span class="dv">80</span>,<span class="dv">85</span>,<span class="dv">90</span>,<span class="dv">95</span>,<span class="dv">100</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="comparing-univariate-displays-across-factor-levels" class="level5">
<h5 class="anchored" data-anchor-id="comparing-univariate-displays-across-factor-levels">Comparing univariate displays across factor levels</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latticeExtra, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fossum <span class="ot">&lt;-</span> <span class="fu">subset</span>(DAAG<span class="sc">::</span>possum, sex<span class="sc">==</span><span class="st">"f"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>femlen <span class="ot">&lt;-</span> DAAG<span class="sc">::</span><span class="fu">bounce</span>(fossum[[<span class="st">"totlngth"</span>]], <span class="at">d=</span><span class="fl">0.1</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel A</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>yaxpos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>)<span class="sc">/</span>(<span class="dv">5</span><span class="sc">*</span><span class="fu">nrow</span>(fossum))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(<span class="fu">list</span>(<span class="at">val =</span> femlen), <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>gph1 <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(<span class="sc">~</span>femlen, <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.55</span>,<span class="fl">2.75</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">70</span>,<span class="dv">100</span>), </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales=</span><span class="fu">list</span>(<span class="at">y=</span><span class="fu">list</span>(<span class="at">draw=</span><span class="cn">FALSE</span>)))<span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        latticeExtra<span class="sc">::</span><span class="fu">layer</span>(<span class="fu">panel.rug</span>(x,<span class="at">pch=</span><span class="st">"|"</span>))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>legstat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(z<span class="sc">$</span>out,z<span class="sc">$</span>stats), <span class="at">y=</span><span class="fu">c</span>(<span class="fl">1.08</span>, <span class="fu">rep</span>(<span class="fl">1.3</span>,<span class="dv">5</span>)),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">tx=</span><span class="fu">c</span>(<span class="st">"Outlier?"</span>, <span class="st">"Smallest value"</span>, <span class="st">"lower quartile"</span>, <span class="st">"median"</span>, </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>       <span class="st">"upper quartile"</span>,  <span class="st">"Largest value"</span>), </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">tx2=</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"(outliers excepted)"</span>,<span class="fu">rep</span>(<span class="st">""</span>,<span class="dv">3</span>), <span class="st">"(no outliers)"</span>))</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>gphA <span class="ot">&lt;-</span> gph1<span class="sc">+</span>latticeExtra<span class="sc">::</span><span class="fu">layer</span>(<span class="at">data=</span>legstat,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel.text</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">labels=</span>tx,<span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>),<span class="at">srt=</span><span class="dv">90</span>, <span class="at">cex=</span><span class="fl">0.85</span>),</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">panel.text</span>(<span class="at">x=</span>x[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>)]<span class="sc">+</span><span class="fl">0.75</span>,<span class="at">y=</span><span class="fu">c</span>(<span class="fl">1.125</span>,<span class="fl">1.38</span>),<span class="at">labels=</span>tx2[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">6</span>)],</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">adj=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>),<span class="at">srt=</span><span class="dv">90</span>, <span class="at">cex=</span><span class="fl">0.85</span>))</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel B</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>gph2 <span class="ot">&lt;-</span> <span class="fu">densityplot</span>(<span class="sc">~</span>femlen, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.108</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">70</span>,<span class="dv">100</span>), </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.points=</span><span class="cn">TRUE</span>, <span class="at">pch=</span><span class="st">"|"</span>,<span class="at">cex=</span><span class="fl">1.75</span>, <span class="at">ylab=</span><span class="fu">c</span>(<span class="st">""</span>,<span class="st">"      Density"</span>))</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>gph3 <span class="ot">&lt;-</span> <span class="fu">histogram</span>(<span class="sc">~</span>femlen, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.108</span>), <span class="at">type=</span><span class="st">"density"</span>, </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">scales=</span><span class="fu">list</span>(<span class="at">y=</span><span class="fu">list</span>(<span class="at">at=</span>yaxpos, <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>), <span class="at">col=</span><span class="st">"gray40"</span>)), </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">75</span>,<span class="dv">80</span>,<span class="dv">85</span>,<span class="dv">90</span>,<span class="dv">95</span>,<span class="dv">100</span>), </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="st">'transparent'</span>,<span class="at">border=</span><span class="st">'gray40'</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>gph4 <span class="ot">&lt;-</span> <span class="fu">doubleYScale</span>(gph2, gph3, <span class="at">use.style=</span><span class="cn">FALSE</span>, <span class="at">add.ylab2=</span><span class="cn">FALSE</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>gphB <span class="ot">&lt;-</span> <span class="fu">update</span>(gph4, <span class="at">par.settings=</span><span class="fu">list</span>(<span class="at">fontsize =</span> <span class="fu">list</span>(<span class="at">text=</span><span class="dv">10</span>, <span class="at">points=</span><span class="dv">5</span>)),</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">scales=</span><span class="fu">list</span>(<span class="at">tck=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>)))</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(<span class="fu">c</span>(<span class="st">"B: Density curve, with histogram overlaid"</span><span class="ot">=</span>gphB, </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>         <span class="st">"A: Boxplot, with annotation added"</span><span class="ot">=</span>gphA, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">y.same=</span>F), </span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">as.table=</span><span class="cn">TRUE</span>, <span class="at">between=</span><span class="fu">list</span>(<span class="at">y=</span><span class="fl">1.4</span>), </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">"Total length of female possums (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create boxplot graph object --- Simplified code</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>gph <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(Pop<span class="sc">~</span>totlngth <span class="sc">|</span> sex, <span class="at">data=</span>possum) </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="do">## plot graph, with dotplot distribution of points below boxplots</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>gph <span class="sc">+</span> latticeExtra<span class="sc">::</span><span class="fu">layer</span>(<span class="fu">panel.dotplot</span>(x, <span class="fu">unclass</span>(y)<span class="sc">-</span><span class="fl">0.4</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="subsection-1.2.2-patterns-in-univariate-time-series" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.2.2-patterns-in-univariate-time-series">Subsection 1.2.2: Patterns in univariate time series</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)), <span class="at">heights=</span><span class="fu">c</span>(<span class="fl">2.6</span>,<span class="fl">1.75</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>measles <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>measles</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel A:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">2.0</span>,<span class="fl">0.5</span>,<span class="dv">0</span>))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log10</span>(measles), <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylim=</span><span class="fu">log10</span> (<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5000</span><span class="sc">*</span><span class="dv">540</span>)),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">" Deaths"</span>, <span class="at">yaxt=</span><span class="st">"n"</span>, <span class="at">fg=</span><span class="st">"gray"</span>, <span class="at">adj=</span><span class="fl">0.16</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>londonpop <span class="ot">&lt;-</span><span class="fu">ts</span>(<span class="fu">c</span>(<span class="dv">1088</span>, <span class="dv">1258</span>, <span class="dv">1504</span>, <span class="dv">1778</span>, <span class="dv">2073</span>, <span class="dv">2491</span>, <span class="dv">2921</span>, <span class="dv">3336</span>, <span class="dv">3881</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">4266</span>, <span class="dv">4563</span>, <span class="dv">4541</span>, <span class="dv">4498</span>, <span class="dv">4408</span>), <span class="at">start=</span><span class="dv">1801</span>, <span class="at">end=</span><span class="dv">1931</span>, <span class="at">deltat=</span><span class="dv">10</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">log10</span>(londonpop<span class="sc">*</span><span class="dv">500</span>), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span>.<span class="dv">5</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>ytiks1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fu">log10</span>(ytiks1), <span class="at">labels=</span><span class="fu">paste</span>(ytiks1), <span class="at">lwd=</span><span class="dv">0</span>, <span class="at">lwd.ticks=</span><span class="dv">1</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">log10</span>(ytiks1), <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mgp=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">0</span>))</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>ytiks2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1000000</span>, <span class="dv">5000000</span>)  <span class="do">## London population in thousands</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">log10</span>(ytiks2<span class="sc">*</span><span class="fl">0.5</span>), <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1650</span>,<span class="at">to=</span><span class="dv">1950</span>,<span class="at">by=</span><span class="dv">50</span>), <span class="at">col =</span> <span class="st">"lightgray"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">line=</span><span class="fl">0.5</span>, <span class="st">"Population"</span>, <span class="at">adj=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">1.15</span>, <span class="at">las=</span><span class="dv">3</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fu">log10</span>(ytiks2<span class="sc">*</span><span class="fl">0.6</span>), <span class="at">labels=</span><span class="fu">paste</span>(ytiks2), <span class="at">tcl=</span><span class="fl">0.3</span>,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">hadj=</span><span class="dv">0</span>, <span class="at">lwd=</span><span class="dv">0</span>, <span class="at">lwd.ticks=</span><span class="dv">1</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="fl">0.3</span>, <span class="st">"A (1629-1939)"</span>, <span class="at">adj=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">1.15</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel B: window from 1840 to 1882</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mgp=</span><span class="fu">c</span>(<span class="fl">2.0</span>,<span class="fl">0.5</span>,<span class="dv">0</span>))</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">window</span>(measles, <span class="at">start=</span><span class="dv">1840</span>, <span class="at">end=</span><span class="dv">1882</span>), <span class="at">xlab=</span><span class="st">""</span>,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="at">ylab=</span><span class="st">"Deaths    Pop (1000s)"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4200</span>), <span class="at">fg=</span><span class="st">"gray"</span>)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">window</span>(londonpop, <span class="at">start=</span><span class="dv">1840</span>, <span class="at">end=</span><span class="dv">1882</span>), <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">0.5</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="fl">0.5</span>, <span class="st">"B (1841-1881)"</span>, <span class="at">adj=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">1.15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="subsection-1.2.3-visualizing-relationships-between-pairs-of-variables" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.2.3-visualizing-relationships-between-pairs-of-variables">Subsection 1.2.3: Visualizing relationships between pairs of variables</h4>
</section>
<section id="subsection-1.2.4-response-lines-andor-curves" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.2.4-response-lines-andor-curves">Subsection 1.2.4: Response lines (and/or curves)</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty=</span><span class="st">"s"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(distance.traveled <span class="sc">~</span> starting.point, <span class="at">data=</span>DAAG<span class="sc">::</span>modelcars, <span class="at">fg=</span><span class="st">"gray"</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">12.5</span>), <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">xlab =</span> <span class="st">"Distance up ramp (cm)"</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="at">ylab=</span><span class="st">"Distance traveled (cm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="subsection-1.2.5-multiple-variables-and-times" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.2.5-multiple-variables-and-times">Subsection 1.2.5: Multiple variables and times</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Apply function range to columns of data frame jobs (DAAG)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(DAAG<span class="sc">::</span>jobs, range)  <span class="do">## NB: `BC` = British Columbia</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel A: Basic plot; all series in a single panel; use log y-scale</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>formRegions <span class="ot">&lt;-</span> Ontario<span class="sc">+</span>Quebec<span class="sc">+</span>BC<span class="sc">+</span>Alberta<span class="sc">+</span>Prairies<span class="sc">+</span>Atlantic <span class="sc">~</span> Date</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>basicGphA <span class="ot">&lt;-</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xyplot</span>(formRegions, <span class="at">outer=</span><span class="cn">FALSE</span>, <span class="at">data=</span>DAAG<span class="sc">::</span>jobs, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">xlab=</span><span class="st">""</span>, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab=</span><span class="st">"Number of workers"</span>, <span class="at">scales=</span><span class="fu">list</span>(<span class="at">y=</span><span class="fu">list</span>(<span class="at">log=</span><span class="st">"e"</span>)),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">auto.key=</span><span class="fu">list</span>(<span class="at">space=</span><span class="st">"right"</span>, <span class="at">lines=</span><span class="cn">TRUE</span>, <span class="at">points=</span><span class="cn">FALSE</span>))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## `outer=FALSE`: plot all columns in one panel</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel B: Separate panels (`outer=TRUE`); sliced log scale</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>basicGphB <span class="ot">&lt;-</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xyplot</span>(formRegions, <span class="at">data=</span>DAAG<span class="sc">::</span>jobs, <span class="at">outer=</span><span class="cn">TRUE</span>, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>), </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">"Number of workers"</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">scales=</span><span class="fu">list</span>(<span class="at">y=</span><span class="fu">list</span>(<span class="at">relation=</span><span class="st">"sliced"</span>, <span class="at">log=</span><span class="cn">TRUE</span>)))</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Provinces are in order of number of workers in Dec96</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Create improved x- and y-axis tick labels; will update to use</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>datelabpos <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">95</span>, <span class="at">by=</span><span class="fl">0.5</span>, <span class="at">length=</span><span class="dv">5</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>datelabs <span class="ot">&lt;-</span> <span class="fu">format</span>(<span class="fu">seq</span>(<span class="at">from=</span><span class="fu">as.Date</span>(<span class="st">"1Jan1995"</span>, <span class="at">format=</span><span class="st">"%d%b%Y"</span>),</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by=</span><span class="st">"6 month"</span>, <span class="at">length=</span><span class="dv">5</span>), <span class="st">"%b%y"</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Now create $y$-labels that have numbers, with log values underneath</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>ylabposA <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">pretty</span>(<span class="fu">log</span>(<span class="fu">unlist</span>(DAAG<span class="sc">::</span>jobs[,<span class="sc">-</span><span class="dv">7</span>])), <span class="dv">5</span>))</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>ylabelsA <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">round</span>(ylabposA),<span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">log</span>(ylabposA), <span class="st">")"</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Repeat, now with 100 ticks, to cover all 6 slices of the scale</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>ylabposB <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">pretty</span>(<span class="fu">log</span>(<span class="fu">unlist</span>(DAAG<span class="sc">::</span>jobs[,<span class="sc">-</span><span class="dv">7</span>])), <span class="dv">100</span>))</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>ylabelsB <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">round</span>(ylabposB),<span class="st">"</span><span class="sc">\n</span><span class="st">("</span>, <span class="fu">log</span>(ylabposB), <span class="st">")"</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>gphA <span class="ot">&lt;-</span> <span class="fu">update</span>(basicGphA, <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">at=</span>datelabpos, <span class="at">labels=</span>datelabs),</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span><span class="fu">list</span>(<span class="at">at=</span>ylabposA, <span class="at">labels=</span>ylabelsA)))</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>gphB <span class="ot">&lt;-</span> <span class="fu">update</span>(basicGphB, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fl">0.25</span>, <span class="at">y=</span><span class="fl">0.25</span>),</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">at=</span>datelabpos, <span class="at">labels=</span>datelabs),</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span><span class="fu">list</span>(<span class="at">at=</span>ylabposB, <span class="at">labels=</span>ylabelsB)))</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>layout.list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">layout.heights=</span><span class="fu">list</span>(<span class="at">top.padding=</span><span class="dv">0</span>,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">bottom.padding=</span><span class="dv">0</span>, <span class="at">sub=</span><span class="dv">0</span>, <span class="at">xlab=</span><span class="dv">0</span>), </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fontsize=</span><span class="fu">list</span>(<span class="at">text=</span><span class="dv">8</span>, <span class="at">points=</span><span class="dv">5</span>))</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>jobstheme <span class="ot">&lt;-</span> <span class="fu">modifyList</span>(<span class="fu">ggplot2like</span>(<span class="at">pch=</span><span class="dv">1</span>, <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">col.line=</span><span class="st">'black'</span>, <span class="at">cex=</span><span class="fl">0.75</span>),layout.list)</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">update</span>(gphA, <span class="at">par.settings=</span>jobstheme, <span class="at">axis=</span>axis.grid,</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="fu">list</span>(<span class="st">"A: Same vertical log scale"</span>,<span class="at">y=</span><span class="dv">0</span>)),</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">position=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.615</span>,<span class="fl">0.9</span>,<span class="dv">1</span>), <span class="at">newpage=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">update</span>(gphB, <span class="at">par.settings=</span>jobstheme, <span class="at">axis=</span>axis.grid,</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="fu">list</span>(<span class="st">"B: Sliced vertical log scale"</span>,<span class="at">y=</span><span class="dv">0</span>)),</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">position=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.625</span>), <span class="at">newpage=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">1230</span>,<span class="dv">1860</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">10.5</span>), <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">bty=</span><span class="st">"n"</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">type=</span><span class="st">"n"</span>, <span class="at">log=</span><span class="st">"x"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>xpoints <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1366</span>, <span class="dv">1436</span>, <span class="dv">1752</span>, <span class="dv">1840</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>xpoints, <span class="at">labels=</span><span class="cn">FALSE</span>, <span class="at">tck=</span><span class="fl">0.01</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">0</span>, <span class="at">lwd.ticks=</span><span class="dv">1</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>xpoints[i],</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">labels=</span><span class="fu">substitute</span>(<span class="fu">italic</span>(a), <span class="fu">list</span>(<span class="at">a=</span><span class="fu">paste</span>(xpoints[i]))),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">line=</span><span class="sc">-</span><span class="fl">2.25</span>, <span class="at">lty=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">0.8</span>, <span class="at">lwd=</span><span class="dv">0</span>, <span class="at">lwd.ticks=</span><span class="dv">1</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">rep</span>(xpoints[i],<span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span><span class="sc">*</span><span class="fu">par</span>()[[<span class="st">"cxy"</span>]][<span class="dv">2</span>]), <span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>axpos <span class="ot">&lt;-</span> <span class="dv">1250</span><span class="sc">*</span><span class="fu">cumprod</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">rep</span>(<span class="fl">1.2</span>,<span class="dv">2</span>)))</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(axpos,<span class="dv">1840</span>), <span class="at">labels=</span>F, <span class="at">lwd.ticks=</span><span class="dv">0</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>lab <span class="ot">&lt;-</span> <span class="fu">round</span>(axpos)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>axpos, <span class="at">labels=</span>lab)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>lab2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">round</span>(<span class="fu">log2</span>(xpoints),<span class="dv">3</span>), <span class="cf">function</span>(x)<span class="fu">substitute</span>(<span class="dv">2</span><span class="sc">^</span>a, <span class="fu">list</span>(<span class="at">a=</span>x)))</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>xpoints, <span class="at">labels=</span><span class="fu">as.expression</span>(lab2), <span class="at">line=</span><span class="sc">-</span><span class="fl">3.5</span>, <span class="at">lwd=</span><span class="dv">0</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>labe <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">format</span>(<span class="fu">round</span>(<span class="fu">log</span>(xpoints),<span class="dv">3</span>)), <span class="cf">function</span>(x)<span class="fu">substitute</span>(e<span class="sc">^</span>a, <span class="fu">list</span>(<span class="at">a=</span>x)))</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>xpoints, <span class="at">labels=</span><span class="fu">as.expression</span>(labe), <span class="at">line=</span><span class="sc">-</span><span class="dv">5</span>, <span class="at">lwd=</span><span class="dv">0</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>lab10 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">round</span>(<span class="fu">log10</span>(xpoints),<span class="dv">3</span>), <span class="cf">function</span>(x)<span class="fu">substitute</span>(<span class="dv">10</span><span class="sc">^</span>a, <span class="fu">list</span>(<span class="at">a=</span>x)))</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span>xpoints, <span class="at">labels=</span><span class="fu">as.expression</span>(lab10), <span class="at">line=</span><span class="sc">-</span><span class="fl">6.5</span>, <span class="at">lwd=</span><span class="dv">0</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family=</span><span class="st">"mono"</span>, <span class="at">xpd=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="dv">1220</span>, <span class="at">labels=</span><span class="st">"log=2"</span>, <span class="at">line=</span><span class="sc">-</span><span class="fl">3.5</span>, <span class="at">hadj=</span><span class="dv">0</span>, <span class="at">lwd=</span><span class="dv">0</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="dv">1220</span>, <span class="at">labels=</span><span class="st">'log="e"'</span>, <span class="at">line=</span><span class="sc">-</span><span class="dv">5</span>, <span class="at">hadj=</span><span class="dv">0</span>, <span class="at">lwd=</span><span class="dv">0</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="dv">1220</span>, <span class="at">labels=</span><span class="st">"log=10"</span>, <span class="at">line=</span><span class="sc">-</span><span class="fl">6.5</span>, <span class="at">hadj=</span><span class="dv">0</span>, <span class="at">lwd=</span><span class="dv">0</span>)  </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>wid2 <span class="ot">&lt;-</span> <span class="fu">strwidth</span>(<span class="st">"log=2"</span>)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">family=</span><span class="st">"sans"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="subsection-1.2.6-labeling-technicalities" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.2.6-labeling-technicalities">Subsection 1.2.6: *Labeling technicalities</h4>
</section>
<section id="subsection-1.2.7-graphical-displays-for-categorical-data" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.2.7-graphical-displays-for-categorical-data">Subsection 1.2.7: Graphical displays for categorical data</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>stones <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="fu">c</span>(<span class="dv">81</span>,<span class="dv">6</span>,<span class="dv">234</span>,<span class="dv">36</span>,<span class="dv">192</span>,<span class="dv">71</span>,<span class="dv">55</span>,<span class="dv">25</span>), <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>),</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">dimnames=</span><span class="fu">list</span>(<span class="at">Success=</span><span class="fu">c</span>(<span class="st">"yes"</span>,<span class="st">"no"</span>),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">Method=</span><span class="fu">c</span>(<span class="st">"open"</span>,<span class="st">"ultrasound"</span>), <span class="at">Size=</span><span class="fu">c</span>(<span class="st">"&lt;2cm"</span>, <span class="st">"&gt;=2cm"</span>)))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>margin12 <span class="ot">&lt;-</span> <span class="fu">margin.table</span>(stones, <span class="at">margin=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>byMethod <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">prop.table</span>(margin12, <span class="at">margin=</span><span class="dv">2</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>pcGood <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">prop.table</span>(stones, <span class="at">margin=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)[<span class="st">"yes"</span>, , ]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>dimnam <span class="ot">&lt;-</span> <span class="fu">dimnames</span>(stones)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>numOps <span class="ot">&lt;-</span> <span class="fu">margin.table</span>(stones, <span class="at">margin=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>opStats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Good=</span><span class="fu">c</span>(pcGood[<span class="dv">1</span>,],pcGood[<span class="dv">2</span>,]),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">numOps=</span><span class="fu">c</span>(numOps[<span class="dv">1</span>,], numOps[<span class="dv">2</span>,]),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">opType=</span><span class="fu">factor</span>(<span class="fu">rep</span>(dimnam[[<span class="st">"Method"</span>]],<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Size=</span><span class="fu">rep</span>(dimnam[[<span class="st">"Size"</span>]],<span class="dv">2</span>))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>xlim <span class="ot">&lt;-</span> <span class="fu">range</span>(opStats<span class="sc">$</span>Good)<span class="sc">*</span><span class="fu">c</span>(<span class="fl">0.65</span>,<span class="fl">1.015</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(opStats<span class="sc">$</span>numOps)<span class="sc">*</span><span class="fl">1.15</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(numOps<span class="sc">~</span>Good, <span class="at">data=</span>opStats, <span class="at">type=</span><span class="st">"h"</span>, <span class="at">lwd=</span><span class="dv">4</span>, <span class="at">xlim=</span>xlim, <span class="at">ylim=</span>ylim,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">fg=</span><span class="st">"gray"</span>,<span class="at">col=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>),<span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">2</span>)),</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Success rate (%)"</span>, <span class="at">ylab=</span><span class="st">"Number of operations"</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co"># with(opStats, text(numOps~Good, labels=Size,</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                    col=rep(c('blue','red'),rep(2,2)),</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                    offset=0.25,pos=3, cex=0.75))</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>labpos <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">split</span>(opStats, opStats<span class="sc">$</span>Size), </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x)<span class="fu">apply</span>(x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],<span class="dv">2</span>,<span class="cf">function</span>(z)<span class="fu">c</span>(z[<span class="dv">1</span>],<span class="fu">mean</span>(z),z[<span class="dv">2</span>])))</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>sizeNam <span class="ot">&lt;-</span> <span class="fu">names</span>(labpos)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(labpos, <span class="cf">function</span>(x)<span class="fu">lines</span>(x[,<span class="st">'Good'</span>],x[,<span class="st">'numOps'</span>]<span class="sc">+</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">35</span>,<span class="dv">0</span>),</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">type=</span><span class="st">"c"</span>,<span class="at">col=</span><span class="st">"gray"</span>))</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>txtmid <span class="ot">&lt;-</span> <span class="fu">sapply</span>(labpos, <span class="cf">function</span>(x)<span class="fu">c</span>(x[<span class="dv">2</span>,<span class="st">'Good'</span>],x[<span class="dv">2</span>,<span class="st">'numOps'</span>]<span class="sc">+</span><span class="dv">35</span>))</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(txtmid[<span class="dv">1</span>,]<span class="sc">+</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.4</span>,<span class="fl">0.85</span>),txtmid[<span class="dv">2</span>,],<span class="at">labels=</span>sizeNam,<span class="at">col=</span><span class="st">"gray40"</span>,</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>), <span class="at">offset=</span><span class="dv">0</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">xpd=</span><span class="cn">TRUE</span>)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(byMethod[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],<span class="fu">rep</span>(<span class="fu">par</span>()<span class="sc">$</span>usr[<span class="dv">4</span>],<span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">strheight</span>(<span class="st">"^"</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"^"</span>,<span class="st">"^"</span>),</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>),<span class="at">cex=</span><span class="fl">1.2</span>,<span class="at">srt=</span><span class="dv">180</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(byMethod[<span class="dv">1</span>,], <span class="fu">par</span>()<span class="sc">$</span>usr[<span class="dv">4</span>]<span class="sc">+</span><span class="fl">1.4</span><span class="sc">*</span><span class="fu">strheight</span>(<span class="st">"A"</span>),</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels=</span><span class="fu">paste</span>(<span class="fu">round</span>(byMethod[<span class="dv">1</span>,],<span class="dv">1</span>)),<span class="at">cex=</span><span class="fl">0.85</span>)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(byMethod[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="sc">+</span><span class="fu">c</span>(<span class="fl">3.5</span>,<span class="sc">-</span><span class="fl">3.5</span>), <span class="fu">rep</span>(<span class="fu">par</span>()<span class="sc">$</span>usr[<span class="dv">4</span>],<span class="dv">2</span>)<span class="sc">+</span><span class="fl">2.65</span><span class="sc">*</span><span class="fu">strheight</span>(<span class="st">"A"</span>),</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="at">labels=</span><span class="fu">c</span>(<span class="st">"All open"</span>,<span class="st">"All ultrasound"</span>), <span class="at">pos=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">xpd=</span><span class="cn">FALSE</span>)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">100</span><span class="sc">*</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>),<span class="at">col=</span><span class="st">"lightgray"</span>,<span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">10</span><span class="sc">*</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">9</span>),<span class="at">col=</span><span class="st">"lightgray"</span>,<span class="at">lwd=</span><span class="fl">0.5</span>)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">'blue'</span>,<span class="st">'red'</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">cex=</span><span class="fl">0.9</span>,</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">y.intersp=</span><span class="fl">0.75</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Open"</span>,<span class="st">"Ultrasound"</span>),<span class="at">bty=</span><span class="st">"n"</span>,</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">inset=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.01</span>,<span class="sc">-</span><span class="fl">0.01</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="subsection-1.2.8-what-to-look-for-in-plots" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.2.8-what-to-look-for-in-plots">Subsection 1.2.8: What to look for in plots</h4>
<section id="outliers" class="level5">
<h5 class="anchored" data-anchor-id="outliers">Outliers</h5>
</section>
<section id="asymmetry-of-the-distribution" class="level5">
<h5 class="anchored" data-anchor-id="asymmetry-of-the-distribution">Asymmetry of the distribution</h5>
</section>
<section id="changes-in-variability" class="level5">
<h5 class="anchored" data-anchor-id="changes-in-variability">Changes in variability</h5>
</section>
<section id="clustering" class="level5">
<h5 class="anchored" data-anchor-id="clustering">Clustering</h5>
</section>
<section id="nonlinearity" class="level5">
<h5 class="anchored" data-anchor-id="nonlinearity">Nonlinearity</h5>
</section>
<section id="time-trends-in-the-data" class="level5">
<h5 class="anchored" data-anchor-id="time-trends-in-the-data">Time trends in the data</h5>
</section>
</section>
</section>
<section id="section-1.3-data-summary" class="level3">
<h3 class="anchored" data-anchor-id="section-1.3-data-summary">Section 1.3: Data Summary</h3>
<section id="subsection-1.3.1-counts" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.3.1-counts">Subsection 1.3.1: Counts</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Table of counts example: data frame nswpsid1 (DAAG)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Specify `useNA="ifany"` to ensure that any NAs are tabulated</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">with</span>(DAAG<span class="sc">::</span>nswpsid1, <span class="fu">table</span>(trt, nodeg, <span class="at">useNA=</span><span class="st">"ifany"</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(tab) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">trt=</span><span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"training"</span>), <span class="at">educ =</span> <span class="fu">c</span>(<span class="st">"completed"</span>, <span class="st">"dropout"</span>))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tabulation-that-accounts-for-frequencies-or-weights-the-xtabs-function" class="level5">
<h5 class="anchored" data-anchor-id="tabulation-that-accounts-for-frequencies-or-weights-the-xtabs-function">Tabulation that accounts for frequencies or weights – the <code>xtabs()</code> function</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>gph <span class="ot">&lt;-</span> lattice<span class="sc">::</span><span class="fu">bwplot</span>(<span class="fu">log</span>(nassCDS<span class="sc">$</span>weight<span class="sc">+</span><span class="dv">1</span>), <span class="at">xlab=</span><span class="st">"Inverse sampling weights"</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">log</span>(<span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)<span class="sc">+</span><span class="dv">1</span>))), <span class="at">labels=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span><span class="sc">^</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)))))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(gph, <span class="at">par.settings=</span>DAAG<span class="sc">::</span><span class="fu">DAAGtheme</span>(<span class="at">color=</span>F, <span class="at">col.points=</span><span class="st">'gray50'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sampNum <span class="ot">&lt;-</span> <span class="fu">table</span>(nassCDS<span class="sc">$</span>dead)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>popNum <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">xtabs</span>(weight <span class="sc">~</span> dead, <span class="at">data=</span>nassCDS))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="at">Sample=</span>sampNum, <span class="st">"Total number"</span><span class="ot">=</span><span class="fu">round</span>(popNum,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>nassCDS <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>nassCDS</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>Atab <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(weight <span class="sc">~</span> airbag <span class="sc">+</span> dead, <span class="at">data=</span>nassCDS)<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Define a function that calculates Deaths per 1000</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>DeadPer1000 <span class="ot">&lt;-</span> <span class="cf">function</span>(x)<span class="dv">1000</span><span class="sc">*</span>x[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(x)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>Atabm <span class="ot">&lt;-</span> <span class="fu">ftable</span>(<span class="fu">addmargins</span>(Atab, <span class="at">margin=</span><span class="dv">2</span>, <span class="at">FUN=</span>DeadPer1000))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Atabm, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">method=</span><span class="st">"compact"</span>, <span class="at">big.mark=</span><span class="st">","</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>SAtab <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(weight <span class="sc">~</span> seatbelt <span class="sc">+</span> airbag <span class="sc">+</span> dead, <span class="at">data=</span>nassCDS)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="do">## SAtab &lt;- addmargins(SAtab, margin=3, FUN=list(Total=sum))  ## Gdet Totals</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>SAtabf <span class="ot">&lt;-</span> <span class="fu">ftable</span>(<span class="fu">addmargins</span>(SAtab, <span class="at">margin=</span><span class="dv">3</span>, <span class="at">FUN=</span>DeadPer1000), <span class="at">col.vars=</span><span class="dv">3</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(SAtabf, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">method=</span><span class="st">"compact"</span>, <span class="at">big.mark=</span><span class="st">","</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>FSAtab <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(weight <span class="sc">~</span> dvcat <span class="sc">+</span> seatbelt <span class="sc">+</span> airbag <span class="sc">+</span> dead, <span class="at">data=</span>nassCDS)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>FSAtabf <span class="ot">&lt;-</span> <span class="fu">ftable</span>(<span class="fu">addmargins</span>(FSAtab, <span class="at">margin=</span><span class="dv">4</span>, <span class="at">FUN=</span>DeadPer1000), <span class="at">col.vars=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(FSAtabf, <span class="at">digits=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="subsection-1.3.2-summaries-of-information-from-data-frames" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.3.2-summaries-of-information-from-data-frames">Subsection 1.3.2: Summaries of information from data frames</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Individual vine yields, with means by block and treatment overlaid</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>kiwishade <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>kiwishade</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>kiwishade<span class="sc">$</span>block <span class="ot">&lt;-</span> <span class="fu">factor</span>(kiwishade<span class="sc">$</span>block, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"west"</span>,<span class="st">"north"</span>,<span class="st">"east"</span>))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>keyset <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">space=</span><span class="st">"top"</span>, <span class="at">columns=</span><span class="dv">2</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="at">text=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"Individual vine yields"</span>, <span class="st">"Plot means (4 vines)"</span>)),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="at">points=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">cex=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.35</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"gray40"</span>,<span class="st">"black"</span>)))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>panelfun <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y,...){<span class="fu">panel.dotplot</span>(x,y, <span class="at">pch=</span><span class="dv">1</span>, ...)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>av <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">split</span>(x,y),mean); ypos <span class="ot">&lt;-</span> <span class="fu">unique</span>(y)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lpoints</span>(ypos<span class="sc">~</span>av, <span class="at">pch=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"black"</span>)}</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dotplot</span>(shade<span class="sc">~</span>yield <span class="sc">|</span> block, <span class="at">data=</span>kiwishade, <span class="at">col=</span><span class="st">"gray40"</span>, <span class="at">aspect=</span><span class="fl">0.65</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel=</span>panelfun, <span class="at">key=</span>keyset, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Note that parameter settings were given both in the calls</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="do">## to the panel functions and in the list supplied to key.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## mean yield by block by shade: data frame kiwishade (DAAG)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>kiwimeans <span class="ot">&lt;-</span> <span class="fu">with</span>(DAAG<span class="sc">::</span>kiwishade, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aggregate</span>(yield, <span class="at">by=</span><span class="fu">list</span>(block, shade), mean))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(kiwimeans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"block"</span>,<span class="st">"shade"</span>,<span class="st">"meanyield"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(kiwimeans, <span class="dv">4</span>)  <span class="co"># First 4 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="the-benefits-of-data-summary-dengue-status-example" class="level5">
<h5 class="anchored" data-anchor-id="the-benefits-of-data-summary-dengue-status-example">The benefits of data summary – dengue status example</h5>
</section>
</section>
<section id="subsection-1.3.3-measures-of-variation" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.3.3-measures-of-variation">Subsection 1.3.3: Measures of variation</h4>
<section id="cuckoo-eggs-example" class="level5">
<h5 class="anchored" data-anchor-id="cuckoo-eggs-example">Cuckoo eggs example</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width=</span><span class="dv">72</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="do">## SD of length, by species: data frame cuckoos (DAAG)</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">with</span>(cuckoos, <span class="fu">sapply</span>(<span class="fu">split</span>(length,species), <span class="cf">function</span>(x)<span class="fu">c</span>(<span class="fu">sd</span>(x),<span class="fu">length</span>(x))))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">setNames</span>(<span class="fu">paste0</span>(<span class="fu">round</span>(z[<span class="dv">1</span>,],<span class="dv">2</span>),<span class="st">" ("</span>,z[<span class="dv">2</span>,],<span class="st">")"</span>),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">abbreviate</span>(<span class="fu">colnames</span>(z),<span class="dv">11</span>)), <span class="at">quote=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="degrees-of-freedom" class="level5">
<h5 class="anchored" data-anchor-id="degrees-of-freedom">Degrees of freedom</h5>
</section>
</section>
<section id="subsection-1.3.4-inter-quartile-range-iqr-and-median-absolute-deviation-mad" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.3.4-inter-quartile-range-iqr-and-median-absolute-deviation-mad">Subsection 1.3.4: Inter-quartile range (IQR) and median absolute deviation (MAD)</h4>
</section>
<section id="subsection-1.3.5-a-pooled-standard-deviation-estimate" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.3.5-a-pooled-standard-deviation-estimate">Subsection 1.3.5: A pooled standard deviation estimate</h4>
<section id="elastic-bands-example" class="level5">
<h5 class="anchored" data-anchor-id="elastic-bands-example">Elastic bands example</h5>
<p>&lt;<a3_5a>&gt;= sapply(DAAG::two65, function(x) c(Mean=mean(x), sd=sd(x))) |&gt; round(2) @</a3_5a></p>
</section>
</section>
<section id="subsection-1.3.6-effect-size" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.3.6-effect-size">Subsection 1.3.6: Effect size</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setNames</span>(<span class="fu">diff</span>(<span class="fu">c</span>(<span class="at">ambient=</span><span class="fl">244.1</span>, <span class="at">heated=</span><span class="fl">253.5</span>))<span class="sc">/</span><span class="fu">c</span>(<span class="at">sd=</span><span class="fl">10.91</span>), <span class="st">"Effect size"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Data are available in the data frame <code>DAAG::two65</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vignette</span>(<span class="st">'effectsize'</span>, <span class="at">package=</span><span class="st">'effectsize'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="subsection-1.3.7-correlation" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.3.7-correlation">Subsection 1.3.7: Correlation</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">17</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> x2 <span class="ot">&lt;-</span> x3 <span class="ot">&lt;-</span> (<span class="dv">11</span><span class="sc">:</span><span class="dv">30</span>)<span class="sc">/</span><span class="dv">5</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">sd=</span><span class="fl">0.5</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> ((x1 <span class="sc">-</span> <span class="fl">1.75</span>))<span class="sc">^</span><span class="dv">4</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">sd=</span><span class="fl">1.5</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> (x1 <span class="sc">-</span> <span class="fl">3.85</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.015</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> ((<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>))<span class="sc">/</span><span class="dv">20</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> <span class="fu">cos</span>(theta)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> <span class="fu">sin</span>(theta) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">sd=</span><span class="fl">0.6</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fu">rep</span>(x1, <span class="dv">3</span>), x4), <span class="at">y =</span> <span class="fu">c</span>(y1, y2, y3, y4),</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">gp =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="fu">rep</span>(<span class="dv">20</span>, <span class="dv">4</span>))))</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>xysplit <span class="ot">&lt;-</span> <span class="fu">split</span>(xy, xy<span class="sc">$</span>gp)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fu">sapply</span>(xysplit, <span class="cf">function</span>(z)<span class="fu">with</span>(z,<span class="fu">cor</span>(x,y, <span class="at">method=</span><span class="fu">c</span>(<span class="st">"pearson"</span>))))</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>rhoS <span class="ot">&lt;-</span> <span class="fu">sapply</span>(xysplit, <span class="cf">function</span>(z)<span class="fu">with</span>(z,<span class="fu">cor</span>(x,y, <span class="at">method=</span><span class="fu">c</span>(<span class="st">"spearman"</span>))))</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>rnam <span class="ot">&lt;-</span> <span class="fu">as.list</span>(<span class="fu">setNames</span>(<span class="fu">round</span>(<span class="fu">c</span>(rho,rhoS),<span class="dv">2</span>), <span class="fu">paste0</span>(<span class="st">"r"</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>)))</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>striplabs <span class="ot">&lt;-</span> <span class="fu">bquote</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(r<span class="sc">==</span>.(r1), <span class="st">"    "</span>,r[s]<span class="sc">==</span>.(r5)), </span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">paste</span>(r<span class="sc">==</span>.(r2), <span class="st">"    "</span>,r[s]<span class="sc">==</span>.(r6)),</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">paste</span>(r<span class="sc">==</span>.(r3), <span class="st">"    "</span>,r[s]<span class="sc">==</span>.(r7)), </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">paste</span>(r<span class="sc">==</span>.(r4), <span class="st">"    "</span>,r[s]<span class="sc">==</span>.(r8))), rnam)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(y <span class="sc">~</span> x <span class="sc">|</span> gp, <span class="at">data=</span>xy, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>), <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>, </span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">strip=</span><span class="fu">strip.custom</span>(<span class="at">factor.levels=</span>striplabs), <span class="at">aspect=</span><span class="dv">1</span>,</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">scales=</span><span class="fu">list</span>(<span class="at">relation=</span><span class="st">'free'</span>, <span class="at">draw=</span><span class="cn">FALSE</span>), <span class="at">between=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fl">0.5</span>,<span class="at">y=</span><span class="dv">0</span>)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="section-1.4-distributions-quantifying-uncertainty" class="level3">
<h3 class="anchored" data-anchor-id="section-1.4-distributions-quantifying-uncertainty">Section 1.4: Distributions: quantifying uncertainty</h3>
<section id="subsection-1.4.1-discrete-distributions" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.4.1-discrete-distributions">Subsection 1.4.1: Discrete distributions</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">## dbinom(0:10, size=10, prob=0.15)</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setNames</span>(<span class="fu">round</span>(<span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">prob=</span><span class="fl">0.15</span>), <span class="dv">3</span>), <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="at">q=</span><span class="dv">4</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">prob=</span><span class="fl">0.15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qbinom</span>(<span class="at">p =</span> <span class="fl">0.70</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.15</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Check that this lies between the two cumulative probabilities:</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="do">## pbinom(q = 1:2, size=10, prob=0.15)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">15</span>, <span class="at">size=</span><span class="dv">4</span>, <span class="at">p=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## dpois(x = 0:8, lambda = 3)</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setNames</span>(<span class="fu">round</span>(<span class="fu">dpois</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">lambda =</span> <span class="dv">3</span>),<span class="dv">4</span>), <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Probability of &gt; 8 raisins</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 1-ppois(q = 8, lambda = 3)     ## Or, ppois(q=8, lambda=3, lower.tail=FALSE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">ppois</span>(<span class="at">q =</span> <span class="dv">8</span>, <span class="at">lambda =</span> <span class="dv">3</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="at">q=</span><span class="dv">8</span>, <span class="at">lambda=</span><span class="dv">3</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)  <span class="do">## Alternative</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">lambda =</span> <span class="dv">3</span>))       <span class="do">## Another alternative</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>raisins <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">20</span>, <span class="dv">3</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>raisins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="initializing-the-random-number-generator" class="level5">
<h5 class="anchored" data-anchor-id="initializing-the-random-number-generator">Initializing the random number generator</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23286</span>)  <span class="co"># Use to reproduce the sample below</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">15</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">p=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="means-and-variances" class="level5">
<h5 class="anchored" data-anchor-id="means-and-variances">Means and variances</h5>
</section>
</section>
<section id="subsection-1.4.2-continuous-distributions" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.4.2-continuous-distributions">Subsection 1.4.2: Continuous distributions</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>,<span class="at">length=</span><span class="dv">101</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z, <span class="fu">dnorm</span>(z), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">ylab=</span><span class="st">"Normal density"</span>,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">yaxs=</span><span class="st">"i"</span>, <span class="at">bty=</span><span class="st">"L"</span>,  <span class="at">tcl=</span><span class="sc">-</span><span class="fl">0.3</span>, <span class="at">fg=</span><span class="st">"gray"</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">"Distance, in SDs, from mean"</span>, <span class="at">cex.lab=</span><span class="fl">0.9</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(z[z <span class="sc">&lt;=</span> <span class="fl">1.0</span>],<span class="fl">1.0</span>),<span class="fu">c</span>(<span class="fu">dnorm</span>(z[z <span class="sc">&lt;=</span> <span class="fl">1.0</span>]), <span class="fu">dnorm</span>(<span class="sc">-</span><span class="dv">3</span>)), <span class="at">col=</span><span class="st">"grey"</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>chh <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>cxy[<span class="dv">2</span>]</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="sc">-</span><span class="fl">1.8</span>, <span class="fl">0.32</span>, <span class="sc">-</span><span class="fl">0.25</span>, <span class="fl">0.2</span>, <span class="at">length=</span><span class="fl">0.07</span>, <span class="at">xpd=</span>T)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>cump <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">pnorm</span>(<span class="dv">1</span>), <span class="dv">3</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">1.8</span>, <span class="fl">0.32+0.75</span><span class="sc">*</span>chh, <span class="fu">paste</span>(<span class="st">"pnorm(1)</span><span class="sc">\n</span><span class="st">"</span>, <span class="st">"="</span>, cump), <span class="at">xpd=</span>T, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>pnormExs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'pnorm(0)'</span>, <span class="st">'pnorm(1)'</span>, <span class="st">'pnorm(-1.96)'</span>, <span class="st">'pnorm(1.96)'</span>,</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="st">'pnorm(1.96, mean=2)'</span>, <span class="st">'pnorm(1.96, sd=2)'</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>Prob <span class="ot">&lt;-</span> <span class="fu">sapply</span>(pnormExs, <span class="cf">function</span>(x)<span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text=</span>x)))</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Prob)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Prob <span class="ot">&lt;-</span> <span class="fu">round</span>(df<span class="sc">$</span>Prob,<span class="dv">3</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot the normal density, in the range -3 to 3</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">pretty</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>), <span class="dv">30</span>)   <span class="co"># Find ~30 equally spaced points</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>ht <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(z)             <span class="co"># Equivalent to dnorm(z, mean=0, sd=1)</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z, ht, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">xlab=</span><span class="st">"Normal variate"</span>, <span class="at">ylab=</span><span class="st">"Density"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># yaxs="i" locates the axes at the limits of the data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(.<span class="dv">9</span>)          <span class="co"># 90th percentile; mean=0 and SD=1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Additional examples:</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setNames</span>(<span class="fu">qnorm</span>(<span class="fu">c</span>(.<span class="dv">5</span>,.<span class="dv">841</span>,.<span class="dv">975</span>)), <span class="at">nm=</span><span class="fu">c</span>(.<span class="dv">5</span>,.<span class="dv">841</span>,.<span class="dv">975</span>))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">2</span>,.<span class="dv">3</span>))   <span class="co"># -1.282 -0.842 -0.524  (10th, 20th and 30th percentiles)</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(.<span class="dv">1</span>, <span class="at">mean=</span><span class="dv">100</span>, <span class="at">sd=</span><span class="dv">10</span>)  <span class="co"># 87.2 (10th percentile, mean=100, SD=10)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="different-ways-to-represent-distributions" class="level5">
<h5 class="anchored" data-anchor-id="different-ways-to-represent-distributions">Different ways to represent distributions</h5>
</section>
<section id="generating-simulated-samples-from-the-normal-and-other-continuous-distributions" class="level5">
<h5 class="anchored" data-anchor-id="generating-simulated-samples-from-the-normal-and-other-continuous-distributions">Generating simulated samples from the normal and other continuous distributions</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">2</span>)  <span class="co"># Suggest number of digits to display</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">10</span>)          <span class="co"># 10 random values from the normal distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>four <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>nrep <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>seed <span class="ot">&lt;-</span> <span class="dv">21</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>totrows <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.null</span>(totrows))</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>totrows <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">sqrt</span>(nrep))</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>totcols <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(nrep<span class="sc">/</span>totrows)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">range</span>(<span class="fu">pretty</span>(mu <span class="sc">+</span> (<span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.4</span>, <span class="fl">3.4</span>) <span class="sc">*</span> sigma), <span class="dv">50</span>))</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">rep</span>(<span class="dv">0</span>,nrep),<span class="at">y=</span><span class="fu">rep</span>(<span class="dv">0</span>,nrep),<span class="at">n=</span><span class="fu">rep</span>(n,nrep),</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">mm=</span><span class="fu">rep</span>(m,nrep),<span class="at">four=</span><span class="fu">rep</span>(four,nrep))</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>fac <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">paste</span>(<span class="st">"Simulation"</span>, <span class="dv">1</span><span class="sc">:</span>nrep),</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>              lev <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Simulation"</span>, <span class="dv">1</span><span class="sc">:</span>nrep))</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>xlim<span class="ot">&lt;-</span>z</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="do">## ylim&lt;-c(0,dnorm(0)*sqrt(n))</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">split</span>(xy,fac)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>xy<span class="ot">&lt;-</span><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(xy),<span class="cf">function</span>(i){<span class="fu">c</span>(<span class="fu">as.list</span>(xy[[i]]), <span class="fu">list</span>(<span class="at">xlim=</span>xlim,</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylim=</span>ylim))})</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>panel.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">mu =</span> <span class="dv">10</span>, <span class="at">sigma =</span> <span class="dv">1</span>, <span class="at">n2 =</span> <span class="dv">1</span>,</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mm =</span> <span class="dv">100</span>, nrows, ncols, ...)</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  vline <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">1</span>)</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">c</span>(x, x), <span class="fu">c</span>(<span class="dv">0</span>, y), <span class="at">lty =</span> lty, <span class="at">col =</span> col)</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  n2<span class="ot">&lt;-</span>data<span class="sc">$</span>n[<span class="dv">1</span>]</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>  mm<span class="ot">&lt;-</span>data<span class="sc">$</span>mm[<span class="dv">1</span>]</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>  our<span class="ot">&lt;-</span>data<span class="sc">$</span>four[<span class="dv">1</span>]  <span class="do">## Four characters in each unit interval of x</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>  nmid <span class="ot">&lt;-</span> <span class="fu">round</span>(four <span class="sc">*</span> <span class="dv">4</span>)</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>  nn <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="sc">*</span> nmid <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>  <span class="do">#########################################</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> mu<span class="sc">+</span><span class="fu">seq</span>(<span class="at">from=</span><span class="sc">-</span><span class="fl">3.4</span><span class="sc">*</span>sigma, <span class="at">to=</span><span class="fl">3.4</span><span class="sc">*</span>sigma, <span class="at">length=</span>mm)</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>  atx<span class="ot">&lt;-</span><span class="fu">pretty</span>(z)</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>  qz <span class="ot">&lt;-</span> <span class="fu">pnorm</span>((z <span class="sc">-</span> mu)<span class="sc">/</span>sigma)</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>  dz <span class="ot">&lt;-</span> <span class="fu">dnorm</span>((z <span class="sc">-</span> mu)<span class="sc">/</span>sigma)</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>  chw <span class="ot">&lt;-</span> sigma<span class="sc">/</span>four</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>  chh <span class="ot">&lt;-</span> <span class="fu">strheight</span>(<span class="st">"O"</span>)<span class="sc">*</span><span class="fl">0.75</span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>  htfac <span class="ot">&lt;-</span> (mm <span class="sc">*</span> chh)<span class="sc">/</span>four</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(nrows<span class="sc">==</span><span class="dv">1</span><span class="sc">&amp;&amp;</span>ncols<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(z, dz <span class="sc">*</span> htfac)</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(nrows<span class="sc">==</span><span class="dv">1</span>)<span class="fu">axis</span>(<span class="dv">1</span>,<span class="at">at=</span>atx, <span class="at">lwd=</span><span class="dv">0</span>, <span class="at">lwd.ticks=</span><span class="dv">1</span>)</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(mm, mu, sigma<span class="sc">/</span><span class="fu">sqrt</span>(n2))</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>  pos <span class="ot">&lt;-</span> <span class="fu">round</span>((y <span class="sc">-</span> mu)<span class="sc">/</span>sigma <span class="sc">*</span> four)</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>mm) {</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>    nn[nmid <span class="sc">+</span> pos[i]] <span class="ot">&lt;-</span> nn[nmid <span class="sc">+</span> pos[i]] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>    xpos <span class="ot">&lt;-</span> chw <span class="sc">*</span> pos[i]</span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(mu <span class="sc">+</span> xpos, nn[nmid <span class="sc">+</span> pos[i]] <span class="sc">*</span> chh <span class="sc">-</span> chh<span class="sc">/</span><span class="dv">4</span>, <span class="st">"x"</span>)</span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>DAAG<span class="sc">::</span><span class="fu">panelplot</span>(xy,<span class="at">panel=</span>panel.mean,<span class="at">totrows=</span>totrows,<span class="at">totcols=</span>totcols,</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">oma=</span><span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">0</span>, <span class="fu">rep</span>(<span class="fl">0.5</span>,<span class="dv">2</span>)), <span class="at">fg=</span><span class="st">'gray'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## The following gives a conventional histogram representations:</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">21</span>)        <span class="co"># Use to reproduce the data in the figure</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">rnorm</span>(<span class="dv">250</span>), <span class="at">gp=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">rep</span>(<span class="dv">50</span>,<span class="dv">5</span>)))</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">histogram</span>(<span class="sc">~</span>x<span class="sc">|</span>gp, <span class="at">data=</span>df, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>) <span class="co"># 20 numbers, uniform distn on (0, 1)</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rexp</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">rate=</span><span class="dv">3</span>)          <span class="co"># 10 numbers, exponential, mean 1/3.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="subsection-1.4.3-graphical-checks-for-normality" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.4.3-graphical-checks-for-normality">Subsection 1.4.3: Graphical checks for normality</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(DAAG<span class="sc">::</span>pair65))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(tab,<span class="st">"heated-ambient"</span><span class="ot">=</span>tab[<span class="dv">1</span>,]<span class="sc">-</span>tab[<span class="dv">2</span>,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Normal quantile-quantile plot for heated-ambient differences,</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="do">## compared with plots for random normal samples of the same size</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>plt <span class="ot">&lt;-</span> <span class="fu">with</span>(DAAG<span class="sc">::</span>pair65, DAAG<span class="sc">::</span><span class="fu">qreference</span>(heated<span class="sc">-</span>ambient, <span class="at">nrep=</span><span class="dv">10</span>, <span class="at">nrows=</span><span class="dv">2</span>))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(plt, <span class="at">scales=</span><span class="fu">list</span>(<span class="at">tck=</span><span class="fl">0.4</span>), <span class="at">xlab=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="subsection-1.4.4-population-parameters-and-sample-statistics" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.4.4-population-parameters-and-sample-statistics">Subsection 1.4.4: Population parameters and sample statistics</h4>
<section id="the-sampling-distribution-of-the-mean" class="level5">
<h5 class="anchored" data-anchor-id="the-sampling-distribution-of-the-mean">The sampling distribution of the mean</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Generate n sample values; skew population</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>sampfun <span class="ot">=</span> <span class="cf">function</span>(n) <span class="fu">exp</span>(<span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fl">0.5</span>, <span class="at">sd =</span> <span class="fl">0.3</span>))</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>gph <span class="ot">&lt;-</span> DAAG<span class="sc">::</span><span class="fu">sampdist</span>(<span class="at">sampsize =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">30</span>), <span class="at">seed =</span> <span class="dv">23</span>, <span class="at">nsamp =</span> <span class="dv">1000</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> mean, <span class="at">sampvals=</span>sampfun, <span class="at">plot.type =</span> <span class="st">"density"</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>samptheme <span class="ot">&lt;-</span> DAAG<span class="sc">::</span><span class="fu">DAAGtheme</span>(<span class="at">color=</span><span class="cn">FALSE</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">update</span>(gph, <span class="at">scales=</span><span class="fu">list</span>(<span class="at">tck=</span><span class="fl">0.4</span>),  <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>),</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">par.settings=</span>samptheme, <span class="at">main=</span><span class="fu">list</span>(<span class="st">"A: Density curves"</span>, <span class="at">cex=</span><span class="fl">1.25</span>)),</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">position=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">more=</span><span class="cn">TRUE</span>)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>sampfun <span class="ot">=</span> <span class="cf">function</span>(n) <span class="fu">exp</span>(<span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fl">0.5</span>, <span class="at">sd =</span> <span class="fl">0.3</span>))</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>gph <span class="ot">&lt;-</span> DAAG<span class="sc">::</span><span class="fu">sampdist</span>(<span class="at">sampsize =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">30</span>), <span class="at">seed =</span> <span class="dv">23</span>, <span class="at">nsamp =</span> <span class="dv">1000</span>, </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">FUN =</span> mean, <span class="at">sampvals=</span>sampfun, <span class="at">plot.type =</span> <span class="st">"qq"</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">update</span>(gph, <span class="at">scales=</span><span class="fu">list</span>(<span class="at">tck=</span><span class="fl">0.4</span>), <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>),</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">par.settings=</span>samptheme, </span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">main=</span><span class="fu">list</span>(<span class="st">"B: Normal quantile-quantile plots"</span>, <span class="at">cex=</span><span class="fl">1.25</span>)),</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">position=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-standard-error-of-the-median" class="level5">
<h5 class="anchored" data-anchor-id="the-standard-error-of-the-median">The standard error of the median</h5>
</section>
<section id="simulation-in-learning-and-research" class="level5">
<h5 class="anchored" data-anchor-id="simulation-in-learning-and-research">Simulation in learning and research</h5>
</section>
</section>
<section id="subsection-1.4.5-the-t-distribution" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.4.5-the-t-distribution">Subsection 1.4.5: The <span class="math inline">\(t\)</span>-distribution</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="sc">-</span><span class="fl">4.2</span>, <span class="at">to =</span> <span class="fl">4.2</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="dv">0</span>))</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>ylim[<span class="dv">2</span>] <span class="ot">&lt;-</span> ylim[<span class="dv">2</span>]<span class="sc">+</span><span class="fl">0.1</span><span class="sc">*</span><span class="fu">diff</span>(ylim)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>h1 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>h3 <span class="ot">&lt;-</span> <span class="fu">dt</span>(x, <span class="dv">3</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>h8 <span class="ot">&lt;-</span> <span class="fu">dt</span>(x,<span class="dv">8</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, h1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">yaxs=</span><span class="st">"i"</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="at">bty=</span><span class="st">"L"</span>, <span class="at">ylim=</span>ylim, <span class="at">fg=</span><span class="st">"gray"</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>,<span class="at">line=</span><span class="fl">0.5</span>, <span class="st">"A: Normal (t8 overlaid)"</span>, <span class="at">adj=</span><span class="sc">-</span><span class="fl">0.2</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, h8, <span class="at">col=</span><span class="st">"grey60"</span>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">line=</span><span class="fl">1.75</span>, <span class="st">"No. of SEMs from mean"</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">2</span>, <span class="at">line=</span><span class="fl">2.0</span>, <span class="st">"Probability density"</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>chh <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>cxy[<span class="dv">2</span>]</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>topleft <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>usr[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)] <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span><span class="sc">*</span>chh)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(topleft[<span class="dv">1</span>], topleft[<span class="dv">2</span>], <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"grey60"</span>),</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Normal"</span>,<span class="st">"t (8 d.f.)"</span>), <span class="at">bty=</span><span class="st">"n"</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, h1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">xaxs=</span><span class="st">"i"</span>,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="at">ylab =</span> <span class="st">""</span>, <span class="at">yaxs=</span><span class="st">"i"</span>, <span class="at">bty=</span><span class="st">"L"</span>, <span class="at">ylim=</span>ylim, <span class="at">fg=</span><span class="st">"gray"</span>)</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>,<span class="at">line=</span><span class="fl">0.5</span>, <span class="st">"B: Normal (t3 overlaid)"</span>, <span class="at">adj=</span><span class="sc">-</span><span class="fl">0.2</span>)</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, h3, <span class="at">col=</span><span class="st">"grey60"</span>)</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">line=</span><span class="fl">1.75</span>, <span class="st">"No. of SEMs from mean"</span>)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="do">## mtext(side=2, line=2.0, "Probability density")</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(topleft[<span class="dv">1</span>], topleft[<span class="dv">2</span>], <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"grey60"</span>),</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a><span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Normal"</span>,<span class="st">"t (3 d.f.)"</span>), <span class="at">bty=</span><span class="st">"n"</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Panels C and D</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>cump <span class="ot">&lt;-</span> <span class="fl">0.975</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="sc">-</span><span class="fl">3.9</span>, <span class="at">to =</span> <span class="fl">3.9</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>ylim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dnorm</span>(<span class="dv">0</span>))</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>plotfun <span class="ot">&lt;-</span> <span class="cf">function</span>(cump, <span class="at">dfun =</span> dnorm, <span class="at">qfun=</span>qnorm,</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="at">ytxt =</span> <span class="st">"Probability density"</span>,</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="at">txt1=</span><span class="st">"qnorm"</span>, <span class="at">txt2=</span><span class="st">""</span>, ...)</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">dfun</span>(x)</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, h, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">xaxt=</span><span class="st">"n"</span>,</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a><span class="at">ylab =</span> ytxt, <span class="at">yaxs=</span><span class="st">"i"</span>, <span class="at">bty=</span><span class="st">"L"</span>, <span class="at">ylim=</span>ylim, <span class="at">fg=</span><span class="st">"gray"</span>,</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>...)</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>), <span class="at">cex=</span><span class="fl">0.8</span>, <span class="at">lwd=</span><span class="dv">0</span>, <span class="at">lwd.ticks=</span><span class="dv">1</span>)</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>((<span class="sc">-</span><span class="dv">3</span>)<span class="sc">:</span><span class="dv">3</span>), <span class="at">labels=</span>F, <span class="at">lwd=</span><span class="dv">0</span>, <span class="at">lwd.ticks=</span><span class="dv">1</span>)</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>tailp <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>cump</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qfun</span>(cump)</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>ztail <span class="ot">&lt;-</span> <span class="fu">pretty</span>(<span class="fu">c</span>(z,<span class="dv">4</span>),<span class="dv">20</span>)</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>htail <span class="ot">&lt;-</span> <span class="fu">dfun</span>(ztail)</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(z,z,ztail,<span class="fu">max</span>(ztail)), <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">dfun</span>(z),htail,<span class="dv">0</span>), <span class="at">col=</span><span class="st">"gray"</span>)</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">0</span>, <span class="fl">0.5</span><span class="sc">*</span><span class="fu">dfun</span>(z)<span class="sc">+</span><span class="fl">0.08</span><span class="sc">*</span><span class="fu">dfun</span>(<span class="dv">0</span>),</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">round</span>(tailp, <span class="dv">3</span>), <span class="st">" + "</span>, <span class="fu">round</span>(<span class="dv">1-2</span><span class="sc">*</span>tailp,<span class="dv">3</span>),</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a><span class="st">"</span><span class="sc">\n</span><span class="st">= "</span>, <span class="fu">round</span>(cump, <span class="dv">3</span>), <span class="at">sep=</span><span class="st">""</span>), <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">rep</span>(z, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dfun</span>(z)))</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">rep</span>(<span class="sc">-</span>z, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">dfun</span>(z)), <span class="at">col=</span><span class="st">"gray60"</span>)</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>chh <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>cxy[<span class="dv">2</span>]</span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(z, <span class="sc">-</span><span class="fl">1.5</span><span class="sc">*</span>chh,z,<span class="sc">-</span><span class="fl">0.1</span><span class="sc">*</span>chh, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">xpd=</span>T)</span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(z, <span class="sc">-</span><span class="fl">2.5</span><span class="sc">*</span>chh, <span class="fu">paste</span>(txt1, <span class="st">"("</span>, cump, txt2, <span class="st">")"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">= "</span>,</span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(z,<span class="dv">2</span>), <span class="at">sep=</span><span class="st">""</span>), <span class="at">xpd=</span>T)</span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> z <span class="sc">+</span> .<span class="dv">3</span></span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dfun</span>(x1)<span class="sc">*</span><span class="fl">0.35</span></span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">dfun</span>(<span class="dv">0</span>)<span class="sc">*</span><span class="fl">0.2</span></span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="sc">-</span><span class="fl">2.75</span>, y0, <span class="sc">-</span>x1, y1, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">col=</span><span class="st">"gray60"</span>)</span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="fl">2.75</span>, y0, x1, y1, <span class="at">length=</span><span class="fl">0.1</span>)</span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">2.75</span>, y0<span class="fl">+0.5</span><span class="sc">*</span>chh, tailp, <span class="at">col=</span><span class="st">"gray60"</span>)</span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.75</span>, y0<span class="fl">+0.5</span><span class="sc">*</span>chh, tailp)</span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a><span class="do">## ytxt &lt;- "t probability density (8 d.f.)"</span></span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a><span class="fu">plotfun</span>(<span class="at">cump=</span>cump, <span class="at">cex.lab=</span><span class="fl">1.05</span>)</span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="fl">1.25</span>, <span class="st">"C: Normal distribution"</span>, <span class="at">adj=</span><span class="sc">-</span><span class="fl">0.2</span>)</span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a>ytxt <span class="ot">&lt;-</span> <span class="st">"t probability density (8 d.f.)"</span></span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a><span class="fu">plotfun</span>(<span class="at">cump=</span>cump, <span class="at">dfun=</span><span class="cf">function</span>(x)<span class="fu">dt</span>(x, <span class="dv">8</span>),</span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">qfun=</span><span class="cf">function</span>(x)<span class="fu">qt</span>(x, <span class="dv">8</span>),</span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">ytxt=</span><span class="st">""</span>, <span class="at">txt1=</span><span class="st">"qt"</span>, <span class="at">txt2=</span><span class="st">", 8"</span>, <span class="at">cex.lab=</span><span class="fl">1.05</span>)</span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="fl">1.25</span>, <span class="st">"D: t distribution (8 df)"</span>, <span class="at">adj=</span><span class="sc">-</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.975</span>,<span class="fl">0.995</span>), <span class="at">mean=</span><span class="dv">0</span>)    <span class="co"># normal distribution</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.975</span>, <span class="fl">0.995</span>), <span class="at">df=</span><span class="dv">8</span>)        <span class="co"># t-distribution with 8 d.f.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="subsection-1.4.6-the-likelihood-and-maximum-likelihood-estimation" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.4.6-the-likelihood-and-maximum-likelihood-estimation">Subsection 1.4.6: The likelihood, and maximum likelihood estimation</h4>
</section>
</section>
<section id="section-1.5-simple-forms-of-regression-model" class="level3">
<h3 class="anchored" data-anchor-id="section-1.5-simple-forms-of-regression-model">Section 1.5: Simple forms of regression model</h3>
<section id="subsection-1.5.1-line-or-curve" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.5.1-line-or-curve">Subsection 1.5.1: Line or curve?</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>roller <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>roller</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">cbind</span>(roller, <span class="st">"depression/weight ratio"</span><span class="ot">=</span><span class="fu">round</span>(roller[,<span class="dv">2</span>]<span class="sc">/</span>roller[,<span class="dv">1</span>],<span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="using-models-to-predict" class="level5">
<h5 class="anchored" data-anchor-id="using-models-to-predict">Using models to predict</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>roller<span class="sc">$</span>depression</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>roller<span class="sc">$</span>weight</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>pretext <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">reg =</span> <span class="st">"A"</span>, <span class="at">lo =</span> <span class="st">"B"</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(curve <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"reg"</span>, <span class="st">"lo"</span>)) {</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(x, y, <span class="at">xlab =</span> <span class="st">"Roller weight (t)"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">12.75</span>), <span class="at">fg=</span><span class="st">"gray"</span>,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"Depression in lawn (mm)"</span>, <span class="at">type=</span><span class="st">"n"</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x, y, <span class="at">cex=</span><span class="fl">0.8</span>, <span class="at">pch =</span> <span class="dv">4</span>)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">3</span>, <span class="at">line =</span> <span class="fl">0.25</span>, pretext[curve], <span class="at">adj =</span> <span class="dv">0</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  topleft <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>usr[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)]</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  chw <span class="ot">&lt;-</span> <span class="fu">strwidth</span>(<span class="st">"O"</span>); chh <span class="ot">&lt;-</span> <span class="fu">strheight</span>(<span class="st">"O"</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(topleft[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">rep</span>(<span class="fl">0.75</span>,<span class="dv">2</span>)<span class="sc">*</span>chw,topleft[<span class="dv">2</span>]<span class="sc">-</span><span class="fu">c</span>(<span class="fl">0.75</span>,<span class="fl">1.8</span>)<span class="sc">*</span>chh,</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"gray40"</span>), <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(topleft[<span class="dv">1</span>]<span class="sc">+</span><span class="fu">rep</span>(<span class="fl">1.2</span>,<span class="dv">2</span>)<span class="sc">*</span>chw, topleft[<span class="dv">2</span>]<span class="sc">-</span><span class="fu">c</span>(<span class="fl">0.75</span>,<span class="fl">1.8</span>)<span class="sc">*</span>chh,</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">"Data values"</span>, <span class="st">"Fitted values"</span>),<span class="at">adj=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(curve<span class="sc">==</span><span class="st">"lo"</span>)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">text</span>(topleft[<span class="dv">1</span>]<span class="sc">+</span><span class="fl">1.2</span><span class="sc">*</span>chw, topleft[<span class="dv">2</span>]<span class="sc">-</span><span class="fl">2.85</span><span class="sc">*</span>chh,<span class="st">"(smooth)"</span>, <span class="at">adj=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(curve[<span class="dv">1</span>] <span class="sc">==</span> <span class="st">"reg"</span>) {</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> x)</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="dv">0</span>, u<span class="sc">$</span>coef[<span class="dv">1</span>])</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(u)</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> {</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>  lawn.lm<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>  yhat<span class="ot">&lt;-</span><span class="fu">predict</span>(lawn.lm)</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>  xnew<span class="ot">&lt;-</span><span class="fu">pretty</span>(x,<span class="dv">20</span>)</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">&lt;-</span>lawn.lm<span class="sc">$</span>coef</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>  ynew<span class="ot">&lt;-</span>b[<span class="dv">1</span>]<span class="sc">+</span>b[<span class="dv">2</span>]<span class="sc">*</span>xnew<span class="sc">+</span>b[<span class="dv">3</span>]<span class="sc">*</span>xnew<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(xnew,ynew)</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>here <span class="ot">&lt;-</span> y <span class="sc">&lt;</span> yhat</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>yyhat <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">rbind</span>(y[here], yhat[here], <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">sum</span>(here))))</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">rbind</span>(x[here], x[here], <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">sum</span>(here))))</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xx, yyhat, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">"gray"</span>)</span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>here <span class="ot">&lt;-</span> y <span class="sc">&gt;</span> yhat</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>yyhat <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">rbind</span>(y[here], yhat[here], <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">sum</span>(here))))</span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">rbind</span>(x[here], x[here], <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">sum</span>(here))))</span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xx, yyhat, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="st">"gray"</span>)</span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>ns <span class="ot">&lt;-</span> <span class="fu">min</span>((<span class="dv">1</span><span class="sc">:</span>n)[y <span class="sc">-</span> yhat <span class="sc">&gt;=</span> <span class="fl">0.75</span><span class="sc">*</span><span class="fu">max</span>(y <span class="sc">-</span> yhat)])</span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>ypos <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> (y[ns] <span class="sc">+</span> yhat[ns])</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>chw <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>cxy[<span class="dv">1</span>]</span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(x[ns] <span class="sc">-</span> <span class="fl">0.25</span><span class="sc">*</span>chw, ypos, <span class="st">"+ve residual"</span>, <span class="at">adj =</span> <span class="dv">1</span>,<span class="at">cex=</span><span class="fl">0.75</span>, <span class="at">col=</span><span class="st">"gray30"</span>)</span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x, yhat, <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="st">"gray40"</span>)</span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>ns <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span>n)[y <span class="sc">-</span> yhat <span class="sc">==</span> <span class="fu">min</span>(y <span class="sc">-</span> yhat)][<span class="dv">1</span>]</span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a>ypos <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> (y[ns] <span class="sc">+</span> yhat[ns])</span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(x[ns] <span class="sc">+</span> <span class="fl">0.4</span><span class="sc">*</span>chw, ypos, <span class="st">"-ve residual"</span>, <span class="at">adj =</span> <span class="dv">0</span>,<span class="at">cex=</span><span class="fl">0.75</span>,<span class="at">col=</span><span class="st">"gray30"</span>)</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="which-model-is-best-line-or-curve" class="level5">
<h5 class="anchored" data-anchor-id="which-model-is-best-line-or-curve">Which model is best — line or curve?</h5>
</section>
</section>
<section id="subsection-1.5.2-fitting-models-the-model-formula" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.5.2-fitting-models-the-model-formula">Subsection 1.5.2: Fitting models – the model formula</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fit line - by default, this fits intercept &amp; slope.</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>roller.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(depression <span class="sc">~</span> weight, <span class="at">data=</span>DAAG<span class="sc">::</span>roller)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Compare with the code used to plot the data</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(depression <span class="sc">~</span> weight, <span class="at">data=</span>DAAG<span class="sc">::</span>roller)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Add the fitted line to the plot</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(roller.lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For a model that omits the intercept term, specify</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(depression <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> weight, <span class="at">data=</span>roller)  <span class="co"># Or, if preferred, replace `0` by `-1`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="model-objects" class="level5">
<h5 class="anchored" data-anchor-id="model-objects">Model objects</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>roller.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(depression <span class="sc">~</span> weight, <span class="at">data=</span>DAAG<span class="sc">::</span>roller)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(roller.lm)     <span class="co"># Get names of list elements</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(roller.lm)           <span class="co"># Extract coefficients</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(roller.lm)        <span class="co"># Extract model summary information</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(roller.lm))  <span class="co"># Extract coefficients and SEs</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(roller.lm)         <span class="co"># Extract fitted values</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(roller.lm)        <span class="co"># Predictions for existing or new data, with SE</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                          <span class="co"># or confidence interval information if required.</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">resid</span>(roller.lm)          <span class="co"># Extract residuals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>roller.lm<span class="sc">$</span>coef            <span class="co"># An alternative is roller.lm[["coef"]]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(roller.lm), <span class="at">digits=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="residual-plots" class="level5">
<h5 class="anchored" data-anchor-id="residual-plots">Residual plots</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Normal quantile-quantile plot, plus 7 reference plots</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>DAAG<span class="sc">::</span><span class="fu">qreference</span>(<span class="fu">residuals</span>(roller.lm), <span class="at">nrep=</span><span class="dv">8</span>, <span class="at">nrows=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simulation-of-regression-data" class="level5">
<h5 class="anchored" data-anchor-id="simulation-of-regression-data">Simulation of regression data</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>roller.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(depression <span class="sc">~</span> weight, <span class="at">data=</span>DAAG<span class="sc">::</span>roller)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>roller.sim <span class="ot">&lt;-</span> <span class="fu">simulate</span>(roller.lm, <span class="at">nsim=</span><span class="dv">20</span>)  <span class="co"># 20 simulations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(DAAG<span class="sc">::</span>roller, <span class="fu">matplot</span>(weight, roller.sim, <span class="at">pch=</span><span class="dv">1</span>, <span class="at">ylim=</span><span class="fu">range</span>(depression)))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(DAAG<span class="sc">::</span>roller, <span class="at">pch=</span><span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="subsection-1.5.3-the-model-matrix-in-regression" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.5.3-the-model-matrix-in-regression">Subsection 1.5.3: The model matrix in regression</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(roller.lm)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Specify coef(roller.lm) to obtain the column multipliers.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="from-straight-line-regression-to-multiple-regression" class="level5">
<h5 class="anchored" data-anchor-id="from-straight-line-regression-to-multiple-regression">From straight line regression to multiple regression</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>mouse.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(brainwt <span class="sc">~</span> lsize<span class="sc">+</span>bodywt, <span class="at">data=</span>DAAG<span class="sc">::</span>litters)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(mouse.lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="section-1.6-data-based-judgments-frequentist-in-a-bayesian-world" class="level3">
<h3 class="anchored" data-anchor-id="section-1.6-data-based-judgments-frequentist-in-a-bayesian-world">Section 1.6: Data-based judgments – frequentist, in a Bayesian world</h3>
<section id="subsection-1.6.1-inference-with-known-prior-probabilities" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.6.1-inference-with-known-prior-probabilities">Subsection 1.6.1: Inference with known prior probabilities</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="do">## `before` is the `prevalence` or `prior`. </span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>after <span class="ot">&lt;-</span> <span class="cf">function</span>(prevalence, sens, spec){</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  prPos <span class="ot">&lt;-</span> sens<span class="sc">*</span>prevalence <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>spec)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>prevalence)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  sens<span class="sc">*</span>prevalence<span class="sc">/</span>prPos}</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Compare posterior for a prior of 0.002 with those for 0.02 and 0.2</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">setNames</span>(<span class="fu">round</span>(<span class="fu">after</span>(<span class="at">prevalence=</span><span class="fu">c</span>(<span class="fl">0.002</span>, <span class="fl">0.02</span>, <span class="fl">0.2</span>), <span class="at">sens=</span>.<span class="dv">8</span>, <span class="at">spec=</span>.<span class="dv">95</span>), <span class="dv">3</span>),</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(<span class="st">"Prevalence=0.002"</span>, <span class="st">"Prevalence=0.02"</span>, <span class="st">"Prevalence=0.2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="relating-incriminating-evidence-to-the-probability-of-guilt" class="level5">
<h5 class="anchored" data-anchor-id="relating-incriminating-evidence-to-the-probability-of-guilt">Relating ‘incriminating’ evidence to the probability of guilt</h5>
</section>
</section>
<section id="subsection-1.6.2-treatment-differences-that-are-on-a-continuous-scale" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.6.2-treatment-differences-that-are-on-a-continuous-scale">Subsection 1.6.2: Treatment differences that are on a continuous scale</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Use pipe syntax, introduced in R 4.1.0</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>sleep <span class="ot">&lt;-</span> <span class="fu">with</span>(datasets<span class="sc">::</span>sleep, extra[group<span class="sc">==</span><span class="dv">2</span>] <span class="sc">-</span> extra[group<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>sleep <span class="sc">|&gt;</span> (<span class="cf">function</span>(x)<span class="fu">c</span>(<span class="at">mean =</span> <span class="fu">mean</span>(x), <span class="at">SD =</span> <span class="fu">sd</span>(x), <span class="at">n=</span><span class="fu">length</span>(x)))() <span class="sc">|&gt;</span> </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>     (<span class="cf">function</span>(x)<span class="fu">c</span>(x, <span class="at">SEM=</span>x[<span class="st">'SD'</span>]<span class="sc">/</span><span class="fu">sqrt</span>(x[<span class="st">'n'</span>])))() <span class="sc">|&gt;</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">"mean"</span>,<span class="st">"SD"</span>,<span class="st">"n"</span>,<span class="st">"SEM"</span>)) <span class="ot">-&gt;</span> stats</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(stats, <span class="at">digits=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Sum of tail probabilities</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(<span class="fl">1.580</span><span class="sc">/</span><span class="fl">0.389</span>, <span class="dv">9</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 95% CI for mean of heated-ambient: data frame DAAG::pair65</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sleep, <span class="at">conf.level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="an-hypothesis-test" class="level5">
<h5 class="anchored" data-anchor-id="an-hypothesis-test">An hypothesis test</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(<span class="fl">4.06</span>, <span class="dv">9</span>, <span class="at">lower.tail=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-p-value-probability-relates-to-a-decision-process" class="level5">
<h5 class="anchored" data-anchor-id="the-p-value-probability-relates-to-a-decision-process">The <span class="math inline">\(p\)</span>-value probability relates to a decision process</h5>
</section>
</section>
<section id="subsection-1.6.3-use-of-simulation-with-p-values" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.6.3-use-of-simulation-with-p-values">Subsection 1.6.3: Use of simulation with <span class="math inline">\(p\)</span>-values</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>eff2stat <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">eff=</span><span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">4</span>,.<span class="dv">8</span>,<span class="fl">1.2</span>), <span class="at">n=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">40</span>), <span class="at">numreps=</span><span class="dv">100</span>,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">FUN=</span><span class="cf">function</span>(x,N)<span class="fu">pt</span>(<span class="fu">sqrt</span>(N)<span class="sc">*</span><span class="fu">mean</span>(x)<span class="sc">/</span><span class="fu">sd</span>(x), <span class="at">df=</span>N<span class="dv">-1</span>, </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">lower.tail=</span><span class="cn">FALSE</span>)){</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  simStat <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">eff=</span><span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">4</span>,.<span class="dv">8</span>,<span class="fl">1.2</span>), <span class="at">N=</span><span class="dv">10</span>, <span class="at">nrep=</span><span class="dv">100</span>, FUN){</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    num <span class="ot">&lt;-</span> N<span class="sc">*</span>nrep<span class="sc">*</span><span class="fu">length</span>(eff)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">array</span>(<span class="fu">rnorm</span>(num, <span class="at">mean=</span>eff), <span class="at">dim=</span><span class="fu">c</span>(<span class="fu">length</span>(eff),nrep,N)) <span class="sc">|&gt;</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">apply</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>, FUN, <span class="at">N=</span>N) </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span>numreps<span class="sc">*</span><span class="fu">length</span>(eff),<span class="at">ncol=</span><span class="fu">length</span>(n))</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) mat[,j] <span class="ot">&lt;-</span> </span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.vector</span>(<span class="fu">simStat</span>(eff, <span class="at">N=</span>n[j], numreps, <span class="at">FUN=</span>FUN))  <span class="do">## length(eff)*numep</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">effsize=</span><span class="fu">rep</span>(<span class="fu">rep</span>(eff, <span class="at">each=</span>numreps), <span class="fu">length</span>(n)),</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">N=</span><span class="fu">rep</span>(n, <span class="at">each=</span>numreps<span class="sc">*</span><span class="fu">length</span>(eff)), <span class="at">stat=</span><span class="fu">as.vector</span>(mat))</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">31</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>df200 <span class="ot">&lt;-</span> <span class="fu">eff2stat</span>(<span class="at">eff=</span><span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">4</span>,.<span class="dv">8</span>,<span class="fl">1.2</span>), <span class="at">n=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>), <span class="at">numreps=</span><span class="dv">200</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>labx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.05</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.8</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>gph <span class="ot">&lt;-</span> <span class="fu">bwplot</span>(<span class="fu">factor</span>(effsize) <span class="sc">~</span> <span class="fu">I</span>(stat<span class="sc">^</span><span class="fl">0.25</span>) <span class="sc">|</span> <span class="fu">factor</span>(N), <span class="at">data=</span>df200, </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">xlab=</span><span class="st">"P-value"</span>, <span class="at">ylab=</span><span class="st">"Effect size"</span>, </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">at=</span>labx<span class="sc">^</span><span class="fl">0.25</span>, <span class="at">labels =</span>labx)))</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(gph<span class="sc">+</span>latticeExtra<span class="sc">::</span><span class="fu">layer</span>(<span class="fu">panel.abline</span>(<span class="at">v=</span>labx[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]<span class="sc">^</span><span class="fl">0.25</span>, <span class="at">col=</span><span class="st">'lightgray'</span>)),</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">strip=</span><span class="fu">strip.custom</span>(<span class="at">factor.levels=</span><span class="fu">paste0</span>(<span class="st">"n="</span>,<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">40</span>))),</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">par.settings=</span>DAAG<span class="sc">::</span><span class="fu">DAAGtheme</span>(<span class="at">color=</span>F, <span class="at">col.points=</span><span class="st">"gray50"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>eff10 <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="fu">subset</span>(df200, N<span class="sc">==</span><span class="dv">10</span><span class="sc">&amp;</span>effsize<span class="sc">==</span><span class="fl">0.2</span>), <span class="fu">c</span>(<span class="at">gt5pc=</span><span class="fu">sum</span>(stat<span class="sc">&gt;</span><span class="fl">0.05</span>), <span class="at">lohi=</span><span class="fu">fivenum</span>(stat)[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)]))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>eff40 <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="fu">subset</span>(df200, N<span class="sc">==</span><span class="dv">40</span><span class="sc">&amp;</span>effsize<span class="sc">==</span><span class="fl">0.2</span>), <span class="fu">c</span>(<span class="at">gt5pc=</span><span class="fu">sum</span>(stat<span class="sc">&gt;</span><span class="fl">0.05</span>), <span class="at">lohi=</span><span class="fu">fivenum</span>(stat)[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="subsection-1.6.4-power-minimizing-the-chance-of-false-positives" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.6.4-power-minimizing-the-chance-of-false-positives">Subsection 1.6.4: Power — minimizing the chance of false positives</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>tf1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="st">'R=0.2'</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.8</span><span class="sc">*</span><span class="dv">50</span>, <span class="fl">0.05</span><span class="sc">*</span><span class="dv">250</span>),</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="st">'R=1'</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.8</span><span class="sc">*</span><span class="dv">150</span>, <span class="fl">0.05</span><span class="sc">*</span><span class="dv">150</span>),</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="st">'R=5'</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.8</span><span class="sc">*</span><span class="dv">200</span>, <span class="fl">0.05</span><span class="sc">*</span><span class="dv">50</span>))</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>tf2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">'0.8 x50'</span>, <span class="st">'0.05x250'</span>),</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">'0.8x150'</span>, <span class="st">'0.05x150'</span>),</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">'0.8x250'</span>, <span class="st">'0.05 x50'</span>))</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>tf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="st">"True positives"</span><span class="ot">=</span><span class="fu">paste</span>(tf2[,<span class="dv">2</span>],tf1[,<span class="dv">2</span>],<span class="at">sep=</span><span class="st">"="</span>),</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="st">"False positives"</span><span class="ot">=</span><span class="fu">paste</span>(tf2[,<span class="dv">1</span>],tf1[,<span class="dv">1</span>],<span class="at">sep=</span><span class="st">"="</span>))</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tf) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(tf1)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tf, <span class="at">quote=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="power-calculations-examples" class="level5">
<h5 class="anchored" data-anchor-id="power-calculations-examples">Power calculations – examples</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power.t.test</span>(<span class="at">d=</span><span class="fl">0.5</span>, <span class="at">sig.level=</span><span class="fl">0.05</span>, <span class="at">type=</span><span class="st">"one.sample"</span>, <span class="at">power=</span><span class="fl">0.8</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>pwr1 <span class="ot">&lt;-</span> <span class="fu">power.t.test</span>(<span class="at">d=</span><span class="fl">0.5</span>, <span class="at">sig.level=</span><span class="fl">0.005</span>, <span class="at">type=</span><span class="st">"one.sample"</span>, <span class="at">power=</span><span class="fl">0.8</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>pwr2 <span class="ot">&lt;-</span> <span class="fu">power.t.test</span>(<span class="at">d=</span><span class="fl">0.5</span>, <span class="at">sig.level=</span><span class="fl">0.005</span>, <span class="at">type=</span><span class="st">"two.sample"</span>, <span class="at">power=</span><span class="fl">0.8</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="do">## d=0.5, sig.level=0.005, One- and two-sample numbers </span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"One sample"</span><span class="ot">=</span>pwr1<span class="sc">$</span>n, <span class="st">"Two sample"</span><span class="ot">=</span>pwr2<span class="sc">$</span>n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>effsize <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">2</span>,.<span class="dv">4</span>,.<span class="dv">8</span>,<span class="fl">1.2</span>); npairs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">40</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>pwr0<span class="fl">.05</span> <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(effsize), <span class="at">ncol=</span><span class="fu">length</span>(npairs),</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">paste0</span>(<span class="st">'ES='</span>,effsize), <span class="fu">paste0</span>(<span class="st">'n='</span>,npairs)))</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>pwr0<span class="fl">.005</span> <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(effsize), <span class="at">ncol=</span><span class="fu">length</span>(npairs),</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">paste0</span>(effsize), <span class="fu">paste0</span>(<span class="st">'n='</span>,npairs)))</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(effsize)) <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(npairs)){</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>    pwr0<span class="fl">.05</span>[i,j] <span class="ot">&lt;-</span> <span class="fu">power.t.test</span>(<span class="at">n=</span>npairs[j],<span class="at">d=</span>effsize[i],<span class="at">sig.level=</span><span class="fl">0.05</span>,</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">type=</span><span class="st">'one.sample'</span>)<span class="sc">$</span>power</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>    pwr0<span class="fl">.005</span>[i,j] <span class="ot">&lt;-</span> <span class="fu">power.t.test</span>(<span class="at">n=</span>npairs[j],<span class="at">d=</span>effsize[i],<span class="at">sig.level=</span><span class="fl">0.005</span>,</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">type=</span><span class="st">'one.sample'</span>)<span class="sc">$</span>power}</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">round</span>(pwr0<span class="fl">.05</span>,<span class="dv">4</span>), <span class="fu">round</span>(pwr0<span class="fl">.005</span>,<span class="dv">4</span>))</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>tab[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,] <span class="ot">&lt;-</span> <span class="fu">round</span>(tab[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,],<span class="dv">3</span>)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>tab[<span class="dv">5</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">'~1.0000'</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>tab[<span class="dv">5</span>,<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="st">'~1.0000'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">quote=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab[,<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">quote=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>effsize <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">2</span>,.<span class="dv">4</span>,.<span class="dv">8</span>,<span class="fl">1.2</span>); npairs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">40</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>pwr0<span class="fl">.05</span> <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(effsize), <span class="at">ncol=</span><span class="fu">length</span>(npairs),</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">paste0</span>(<span class="st">'ES='</span>,effsize), <span class="fu">paste0</span>(<span class="st">'n='</span>,npairs)))</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>pwr0<span class="fl">.005</span> <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(effsize), <span class="at">ncol=</span><span class="fu">length</span>(npairs),</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">paste0</span>(effsize), <span class="fu">paste0</span>(<span class="st">'n='</span>,npairs)))</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(effsize)) <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(npairs)){</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>    pwr0<span class="fl">.05</span>[i,j] <span class="ot">&lt;-</span> <span class="fu">power.t.test</span>(<span class="at">n=</span>npairs[j],<span class="at">d=</span>effsize[i],<span class="at">sig.level=</span><span class="fl">0.05</span>,</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">type=</span><span class="st">'one.sample'</span>)<span class="sc">$</span>power</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    pwr0<span class="fl">.005</span>[i,j] <span class="ot">&lt;-</span> <span class="fu">power.t.test</span>(<span class="at">n=</span>npairs[j],<span class="at">d=</span>effsize[i],<span class="at">sig.level=</span><span class="fl">0.005</span>,</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">type=</span><span class="st">'one.sample'</span>)<span class="sc">$</span>power}</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">round</span>(pwr0<span class="fl">.05</span>,<span class="dv">4</span>), <span class="fu">round</span>(pwr0<span class="fl">.005</span>,<span class="dv">4</span>))</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>tab[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,] <span class="ot">&lt;-</span> <span class="fu">round</span>(tab[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,],<span class="dv">3</span>)</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>tab[<span class="dv">5</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">'~1.0000'</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>tab[<span class="dv">5</span>,<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="st">'~1.0000'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="positive-predictive-values" class="level5">
<h5 class="anchored" data-anchor-id="positive-predictive-values">Positive Predictive Values</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">pretty</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">40</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>postOdds <span class="ot">&lt;-</span> <span class="fu">outer</span>(R<span class="sc">/</span><span class="fl">0.05</span>,<span class="fu">c</span>(.<span class="dv">8</span>,.<span class="dv">3</span>,.<span class="dv">08</span>))</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>PPV <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(R,postOdds<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>postOdds)))</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(PPV) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"R"</span>,<span class="st">"p80"</span>,<span class="st">"p30"</span>,<span class="st">"p8"</span>)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>key <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="fu">list</span>(<span class="at">text=</span><span class="fu">c</span>(<span class="st">"80% power"</span>,<span class="st">"30% power"</span>, <span class="st">"8% power"</span>), <span class="at">cex =</span> <span class="fl">1.0</span>),</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> .<span class="dv">6</span>, <span class="at">y =</span> .<span class="dv">25</span>, <span class="at">color=</span>F)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>gph <span class="ot">&lt;-</span> lattice<span class="sc">::</span><span class="fu">xyplot</span>(p80<span class="sc">+</span>p30<span class="sc">+</span>p8<span class="sc">~</span>R, <span class="at">data=</span>PPV, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">type=</span><span class="fu">c</span>(<span class="st">"l"</span>,<span class="st">"g"</span>), </span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">"Pre-study odds R"</span>, <span class="at">ylab=</span><span class="st">"Post-study probability (PPV)"</span>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="fu">update</span>(gph, <span class="at">scales=</span><span class="fu">list</span>(<span class="at">tck=</span><span class="fl">0.5</span>), <span class="at">key=</span>key) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="subsection-1.6.5-the-future-for-p-values" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.6.5-the-future-for-p-values">Subsection 1.6.5: The future for <span class="math inline">\(p\)</span>-values</h4>
<section id="how-small-a-p-value-is-needed" class="level5">
<h5 class="anchored" data-anchor-id="how-small-a-p-value-is-needed">How small a <span class="math inline">\(p\)</span>-value is needed?</h5>
</section>
</section>
<section id="subsection-1.6.6-reporting-results" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.6.6-reporting-results">Subsection 1.6.6: Reporting results</h4>
<section id="is-there-an-alternative-that-is-more-likely" class="level5">
<h5 class="anchored" data-anchor-id="is-there-an-alternative-that-is-more-likely">Is there an alternative that is more likely?</h5>
</section>
</section>
</section>
<section id="section-1.7-information-statistics-and-bayesian-methods-with-bayes-factors" class="level3">
<h3 class="anchored" data-anchor-id="section-1.7-information-statistics-and-bayesian-methods-with-bayes-factors">Section 1.7: Information statistics and Bayesian methods with Bayes Factors</h3>
<section id="subsection-1.7.1-information-statistics-using-likelihoods-for-model-choice" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.7.1-information-statistics-using-likelihoods-for-model-choice">Subsection 1.7.1: Information statistics – using likelihoods for model choice</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculations using mouse brain weight data</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>mouse.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(brainwt <span class="sc">~</span> lsize<span class="sc">+</span>bodywt, <span class="at">data=</span>DAAG<span class="sc">::</span>litters)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(DAAG<span class="sc">::</span>litters)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>RSSlogLik <span class="ot">&lt;-</span> <span class="fu">with</span>(mouse.lm, n<span class="sc">*</span>(<span class="fu">log</span>(<span class="fu">sum</span>(residuals<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>n)<span class="sc">+</span><span class="dv">1</span><span class="sc">+</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>pi)))</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(mouse.lm))<span class="sc">+</span><span class="dv">1</span>  <span class="co"># NB: p=4 (3 coefficients + 1 scale parameter)</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>n<span class="sc">/</span>(n<span class="sc">-</span>p<span class="dv">-1</span>)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"AICc"</span> <span class="ot">=</span> AICcmodavg<span class="sc">::</span><span class="fu">AICc</span>(mouse.lm), <span class="at">fromlogL=</span>k<span class="sc">*</span>p<span class="dv">-2</span><span class="sc">*</span><span class="fu">logLik</span>(mouse.lm)[<span class="dv">1</span>], </span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">fromFit=</span>k<span class="sc">*</span>p <span class="sc">+</span> RSSlogLik) <span class="sc">|&gt;</span> <span class="fu">print</span>(<span class="at">digits=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="the-sampling-properties-of-the-difference-in-aic-statistics" class="level5">
<h5 class="anchored" data-anchor-id="the-sampling-properties-of-the-difference-in-aic-statistics">The sampling properties of the difference in AIC statistics</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>sim0vs1 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">mu=</span><span class="dv">0</span>, <span class="at">n=</span><span class="dv">15</span>, <span class="at">ntimes=</span><span class="dv">200</span>){</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>a0 <span class="ot">&lt;-</span> a1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(ntimes)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ntimes){</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span>mu, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  m0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">0</span>); m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="dv">1</span>) </span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  a0[i] <span class="ot">&lt;-</span> <span class="fu">AIC</span>(m0); a1[i] <span class="ot">&lt;-</span> <span class="fu">AIC</span>(m1)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">a0=</span>a0, <span class="at">a1=</span>a1, <span class="at">diff01=</span>a0<span class="sc">-</span>a1, <span class="at">mu=</span><span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"mu="</span>,mu)))</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latticeExtra)</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>sim0 <span class="ot">&lt;-</span> <span class="fu">sim0vs1</span>(<span class="at">mu=</span><span class="dv">0</span>)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>sim0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">sim0vs1</span>(<span class="at">mu=</span><span class="fl">0.5</span>)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>simboth <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sim0, sim0<span class="fl">.5</span>)</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>cdiff <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="fu">list</span>(<span class="at">n=</span><span class="dv">15</span>, <span class="at">p=</span><span class="dv">2</span>), <span class="dv">2</span><span class="sc">*</span>(p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>p<span class="sc">/</span>(n<span class="sc">-</span>(p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(diff01 <span class="sc">~</span> a0 <span class="sc">|</span> mu, <span class="at">data=</span>simboth, <span class="at">xlab=</span><span class="st">"AIC(m0)"</span>, <span class="at">ylab=</span><span class="st">"AIC(m0) - AIC(m1)"</span>) <span class="sc">+</span> </span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>  latticeExtra<span class="sc">::</span><span class="fu">layer</span>({<span class="fu">panel.abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">'red'</span>); </span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>         <span class="fu">panel.abline</span>(<span class="at">h=</span>cdiff, <span class="at">lwd=</span><span class="fl">1.5</span>, <span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">alpha=</span><span class="fl">0.5</span>);</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>         <span class="fu">panel.abline</span>(<span class="at">h=</span><span class="sc">-</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">'red'</span>)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="fu">with</span>(sim0, <span class="fu">sum</span>(diff01<span class="sc">&gt;</span><span class="dv">0</span>))<span class="sc">/</span><span class="dv">200</span>, <span class="fu">with</span>(sim0<span class="fl">.5</span>, <span class="fu">sum</span>(diff01<span class="sc">&gt;</span><span class="dv">0</span>))<span class="sc">/</span><span class="dv">200</span>),</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">with</span>(sim0,<span class="fu">sum</span>(diff01<span class="sc">&gt;-</span>cdiff))<span class="sc">/</span><span class="dv">200</span>, <span class="fu">with</span>(sim0<span class="fl">.5</span>, <span class="fu">sum</span>(diff01<span class="sc">&gt;-</span>cdiff))<span class="sc">/</span><span class="dv">200</span>))</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(tab) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"AIC: Proportion choosing m1"</span>,</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"AICc: Proportion choosing m1"</span>),</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">c</span>(<span class="st">"True model is m0"</span>, <span class="st">"True model is m1"</span>))</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="subsection-1.7.2-bayesian-methods-with-bayes-factors" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.7.2-bayesian-methods-with-bayes-factors">Subsection 1.7.2: Bayesian methods with Bayes Factors</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Setting `scale=1/sqrt(2)` gives a mildly narrower distribution</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="st">"pcauchy(1, scale=1)"</span><span class="ot">=</span><span class="fu">pcauchy</span>(<span class="dv">1</span>, <span class="at">scale=</span><span class="dv">1</span>), </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"   pcauchy(1, scale=1/sqrt(2))"</span><span class="ot">=</span><span class="fu">pcauchy</span>(<span class="dv">1</span>, <span class="at">scale=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>))),</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">quote=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="the-cauchy-prior-with-different-choices-of-scale-parameter" class="level5">
<h5 class="anchored" data-anchor-id="the-cauchy-prior-with-different-choices-of-scale-parameter">The Cauchy prior with different choices of scale parameter</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="sc">-</span><span class="fl">4.5</span>, <span class="at">to=</span><span class="fl">4.5</span>, <span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>densMed <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(x,<span class="at">scale=</span><span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>densUltra <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(x, <span class="at">scale=</span><span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>denn <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,densMed, <span class="at">type=</span><span class="st">'l'</span>, <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">xlab=</span><span class="st">""</span>,</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Prior density"</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">fg=</span><span class="st">'gray'</span>)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">line=</span><span class="dv">2</span>, <span class="fu">expression</span>(<span class="st">"Effect size "</span><span class="sc">==</span><span class="fu">phantom</span>(<span class="dv">0</span>)<span class="sc">*</span>delta), <span class="at">cex=</span><span class="fl">1.1</span>)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, denn, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, densUltra,<span class="at">col=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">title=</span><span class="st">"Normal prior"</span>,</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y.intersp=</span><span class="fl">0.8</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">bty=</span><span class="st">'n'</span>, <span class="at">cex=</span><span class="fl">0.8</span>,</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">expression</span>(<span class="fu">bold</span>(<span class="st">'sd=1'</span>)))</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">title=</span><span class="st">"Cauchy priors"</span>, <span class="at">y.intersp=</span><span class="fl">0.8</span>,</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">'red'</span>, <span class="st">'red'</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">cex=</span><span class="fl">0.8</span>,</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bold</span>(<span class="st">'medium'</span>)),</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>         <span class="fu">expression</span>(<span class="fu">bold</span>(<span class="st">'ultrawide'</span>))),<span class="at">bty=</span><span class="st">"n"</span>)</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="fl">0.25</span>, <span class="at">adj=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">1.15</span>,</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expression</span>(<span class="st">"A: Alternative priors for "</span><span class="sc">*</span>delta<span class="sc">==</span><span class="fu">frac</span>(mu,sigma)))</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel B</span></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>pairedDiffs <span class="ot">&lt;-</span> <span class="fu">with</span>(datasets<span class="sc">::</span>sleep, extra[group<span class="sc">==</span><span class="dv">2</span>] <span class="sc">-</span> extra[group<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>ttBF0 <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttestBF</span>(pairedDiffs)</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>simpost <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">posterior</span>(ttBF0, <span class="at">iterations=</span><span class="dv">10000</span>)</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(simpost[,<span class="st">'mu'</span>]), <span class="at">main=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">col=</span><span class="st">"red"</span>,</span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">mgp=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">0.5</span>,<span class="dv">0</span>), <span class="at">ylab=</span><span class="st">"Posterior density"</span>, <span class="at">fg=</span><span class="st">'gray'</span>)</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">1</span>, <span class="at">line=</span><span class="dv">2</span>, <span class="fu">expression</span>(mu), <span class="at">cex=</span><span class="fl">1.1</span>)</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(pairedDiffs), <span class="at">col=</span><span class="st">"gray"</span>)</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>, <span class="at">line=</span><span class="fl">0.5</span>, <span class="fu">expression</span>(<span class="st">"B: Posterior density for "</span><span class="sc">*</span>mu), <span class="at">adj=</span><span class="dv">0</span>, <span class="at">cex=</span><span class="fl">1.15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate and plot density for default prior - Selected lines of code</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="sc">-</span><span class="fl">4.5</span>, <span class="at">to=</span><span class="fl">4.5</span>, <span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>densMed <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(x, <span class="at">scale=</span><span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, densMed, <span class="at">type=</span><span class="st">'l'</span>)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel B</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>pairedDiffs <span class="ot">&lt;-</span> <span class="fu">with</span>(datasets<span class="sc">::</span>sleep, extra[group<span class="sc">==</span><span class="dv">2</span>] <span class="sc">-</span> extra[group<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>ttBF0 <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttestBF</span>(pairedDiffs)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Sample from posterior, and show density plot for mu</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>simpost <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">posterior</span>(ttBF0, <span class="at">iterations=</span><span class="dv">10000</span>)</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(simpost[,<span class="st">'mu'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="a-thought-experiment" class="level5">
<h5 class="anchored" data-anchor-id="a-thought-experiment">A thought experiment</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>tval <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">01</span>,.<span class="dv">005</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span><span class="dv">19</span>), <span class="fu">paste</span>(<span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">01</span>,.<span class="dv">005</span>)))</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>bf01 <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">numeric</span>(<span class="dv">3</span>), <span class="fu">paste</span>(<span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">01</span>,.<span class="dv">005</span>)))</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)bf01[i] <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttest.tstat</span>(tval[i],<span class="at">n1=</span><span class="dv">20</span>, <span class="at">simple=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>pairedDiffs <span class="ot">&lt;-</span> <span class="fu">with</span>(datasets<span class="sc">::</span>sleep, extra[group<span class="sc">==</span><span class="dv">2</span>] <span class="sc">-</span> extra[group<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>ttBF0 <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttestBF</span>(pairedDiffs)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>ttBFwide <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttestBF</span>(pairedDiffs, <span class="at">rscale=</span><span class="dv">1</span>)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>ttBFultra <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttestBF</span>(pairedDiffs, <span class="at">rscale=</span><span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>rscales <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"medium"</span><span class="ot">=</span><span class="fu">sqrt</span>(<span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="st">"wide"</span><span class="ot">=</span><span class="dv">1</span>, <span class="at">ultrawide=</span><span class="fu">sqrt</span>(<span class="dv">2</span>))</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>BF3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">as.data.frame</span>(ttBF0)[[<span class="st">'bf'</span>]], <span class="fu">as.data.frame</span>(ttBFwide)[[<span class="st">'bf'</span>]],</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>         <span class="fu">as.data.frame</span>(ttBFultra)[[<span class="st">'bf'</span>]])</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="fu">setNames</span>(<span class="fu">round</span>(BF3,<span class="dv">2</span>), <span class="fu">c</span>(<span class="st">"medium"</span>, <span class="st">"wide"</span>, <span class="st">"ultrawide"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">t.test</span>(pairedDiffs)[[<span class="st">'p.value'</span>]]</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span>(<span class="sc">-</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">*</span>pval<span class="sc">*</span><span class="fu">log</span>(pval))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="a-null-interval-may-make-better-sense" class="level5">
<h5 class="anchored" data-anchor-id="a-null-interval-may-make-better-sense">A null interval may make better sense</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>min45 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fl">0.75</span><span class="sc">/</span><span class="fu">sd</span>(pairedDiffs),<span class="dv">2</span>)   <span class="do">## Use standardized units</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>ttBFint <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttestBF</span>(pairedDiffs, <span class="at">nullInterval=</span><span class="fu">c</span>(<span class="sc">-</span>min45,min45))</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">as.data.frame</span>(ttBFint)[<span class="st">'bf'</span>],<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>bf01 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ttBFint)[[<span class="st">'bf'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-effect-of-changing-sample-size" class="level5">
<h5 class="anchored" data-anchor-id="the-effect-of-changing-sample-size">The effect of changing sample size</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>t2bfInterval <span class="ot">&lt;-</span> <span class="cf">function</span>(t, <span class="at">n=</span><span class="dv">10</span>, <span class="at">rscale=</span><span class="st">"medium"</span>, <span class="at">mu=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>,.<span class="dv">1</span>)){</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>     null0 <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttest.tstat</span>(<span class="at">t=</span>t, <span class="at">n1=</span>n, <span class="at">nullInterval=</span>mu,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">rscale=</span>rscale,<span class="at">simple=</span><span class="cn">TRUE</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>alt0 <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttest.tstat</span>(<span class="at">t=</span>t, <span class="at">n1=</span>n, <span class="at">nullInterval=</span>mu, <span class="at">rscale=</span>rscale, </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">complement=</span><span class="cn">TRUE</span>, <span class="at">simple=</span><span class="cn">TRUE</span>)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>alt0<span class="sc">/</span>null0</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate Bayes factors</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>); nval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">40</span>,<span class="dv">80</span>,<span class="dv">160</span>)</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>bfDF <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">p=</span>pval, <span class="at">n=</span>nval)</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>pcol <span class="ot">&lt;-</span> <span class="dv">1</span>; ncol <span class="ot">&lt;-</span> <span class="dv">2</span>; tcol <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>bfDF[,<span class="st">'t'</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(bfDF,<span class="dv">1</span>,<span class="cf">function</span>(x){<span class="fu">qt</span>(x[pcol]<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>x[ncol]<span class="sc">-</span><span class="dv">1</span>,                                  <span class="at">lower.tail=</span><span class="cn">FALSE</span>)})</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>other <span class="ot">&lt;-</span> <span class="fu">apply</span>(bfDF,<span class="dv">1</span>,<span class="cf">function</span>(x)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(BayesFactor<span class="sc">::</span><span class="fu">ttest.tstat</span>(<span class="at">t=</span>x[tcol], <span class="at">n1=</span>x[ncol], <span class="at">rscale=</span><span class="st">"medium"</span>,</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">simple=</span><span class="cn">TRUE</span>),</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Now specify a null interval</span></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t2bfInterval</span>(<span class="at">t=</span>x[tcol], <span class="at">n=</span>x[ncol], <span class="at">mu=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>),<span class="at">rscale=</span><span class="st">"medium"</span>)</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>bfDF <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">cbind</span>(bfDF, <span class="fu">t</span>(other)),</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">'p'</span>,<span class="st">'n'</span>,<span class="st">'t'</span>,<span class="st">'bf'</span>,<span class="st">'bfInterval'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>plabpos <span class="ot">&lt;-</span> <span class="fu">with</span>(<span class="fu">subset</span>(bfDF, n<span class="sc">==</span><span class="fu">max</span>(bfDF<span class="sc">$</span>n)), <span class="fu">log</span>((bf<span class="sc">+</span>bfInterval)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>gphA1 <span class="ot">&lt;-</span> lattice<span class="sc">::</span><span class="fu">xyplot</span>(<span class="fu">log</span>(bf)<span class="sc">~</span><span class="fu">log</span>(n), <span class="at">groups=</span><span class="fu">factor</span>(p), <span class="at">data=</span>bfDF,</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">panel=</span><span class="cf">function</span>(x,y,...){</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>                        lattice<span class="sc">::</span><span class="fu">panel.xyplot</span>(x,y,<span class="at">type=</span><span class="st">'b'</span>,...)})</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>ylabA <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>((<span class="sc">-</span><span class="dv">3</span>)<span class="sc">:</span><span class="dv">6</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>scalesA <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">at=</span><span class="fu">log</span>(nval), <span class="at">labels=</span>nval),</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">y=</span><span class="fu">list</span>(<span class="at">at=</span><span class="fu">log</span>(ylabA), <span class="at">labels=</span><span class="fu">signif</span>(ylabA,<span class="dv">2</span>)))</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>keyA <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">corner=</span><span class="fu">c</span>(<span class="fl">0.99</span>,<span class="fl">0.98</span>), <span class="at">lines=</span><span class="fu">list</span>(<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">text=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">'Point null at 0'</span>, <span class="st">"null=(-0.1,0.1)"</span>)))</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>ylim2 <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">c</span>(<span class="fu">min</span>(bfDF[[<span class="st">'bfInterval'</span>]])<span class="sc">-</span><span class="fl">0.05</span>,<span class="dv">150</span>)) </span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>gphA2 <span class="ot">&lt;-</span> lattice<span class="sc">::</span><span class="fu">xyplot</span>(<span class="fu">log</span>(bfInterval)<span class="sc">~</span><span class="fu">log</span>(n), <span class="at">groups=</span><span class="fu">factor</span>(p), <span class="at">lty=</span><span class="dv">2</span>,</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim=</span><span class="fu">c</span>(<span class="fu">log</span>(<span class="fl">3.5</span>),<span class="fu">log</span>(<span class="fu">max</span>(nval)<span class="sc">*</span><span class="fl">3.25</span>)), <span class="at">ylim=</span>ylim2, <span class="at">data=</span>bfDF,</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel=</span><span class="cf">function</span>(x,y,...){</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">panel.xyplot</span>(x,y,<span class="at">type=</span><span class="st">'b'</span>,...)</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">panel.grid</span>(<span class="at">h=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">v=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">panel.text</span>(<span class="fu">rep</span>(<span class="fu">log</span>(<span class="fu">max</span>(nval<span class="sc">*</span><span class="fl">0.975</span>)),<span class="dv">3</span>), plabpos, </span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels=</span><span class="fu">c</span>(<span class="st">'p=0.05'</span>,<span class="st">'0.01'</span>,<span class="st">'0.001'</span>), <span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">par.settings=</span>DAAG<span class="sc">::</span><span class="fu">DAAGtheme</span>(<span class="at">color=</span>T),</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"A: Bayes factor vs sample size"</span>, </span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">"Sample size"</span>, <span class="at">ylab=</span><span class="st">"Bayes factor"</span>, <span class="at">scales=</span>scalesA, <span class="at">key=</span>keyA)</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Panel B</span></span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>bfDF[[<span class="st">'eff'</span>]] <span class="ot">=</span> bfDF[[<span class="st">"t"</span>]]<span class="sc">/</span><span class="fu">sqrt</span>(bfDF[[<span class="st">'n'</span>]])</span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>ylabB <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>((<span class="sc">-</span><span class="dv">3</span>)<span class="sc">:</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a>scalesB<span class="ot">=</span> <span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">at=</span><span class="fu">log</span>(nval), <span class="at">labels=</span>nval),</span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span><span class="fu">list</span>(<span class="at">at=</span><span class="fu">log</span>(ylabB), <span class="at">labels=</span><span class="fu">signif</span>(ylabB,<span class="dv">2</span>)))</span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>keyB <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">corner=</span><span class="fu">c</span>(<span class="fl">0.98</span>,<span class="fl">0.975</span>), <span class="at">lines=</span><span class="fu">list</span>(<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), </span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">points=</span><span class="fu">list</span>(<span class="at">pch=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">text=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="st">'p=0.001'</span>,<span class="st">'p=0.01'</span>,<span class="st">'p=0.05'</span>)))</span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>gphB <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(<span class="fu">log</span>(eff)<span class="sc">~</span><span class="fu">log</span>(n), <span class="at">groups=</span><span class="fu">log</span>(p), <span class="at">data=</span>bfDF, <span class="at">pch=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, </span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a>               <span class="at">type=</span><span class="st">'b'</span>, <span class="at">xlab=</span><span class="st">"Sample size"</span>, <span class="at">ylab=</span><span class="st">"Effect  size"</span>,</span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">par.settings=</span>DAAG<span class="sc">::</span><span class="fu">DAAGtheme</span>(<span class="at">color=</span>T),</span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"B: Effect size vs sample size"</span>, <span class="at">key=</span>keyB, <span class="at">scales=</span>scalesB) <span class="sc">+</span></span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>  latticeExtra<span class="sc">::</span><span class="fu">layer</span>(<span class="fu">panel.grid</span>(<span class="at">h=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">v=</span><span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gphA2<span class="sc">+</span>latticeExtra<span class="sc">::</span><span class="fu">as.layer</span>(gphA1), <span class="at">position=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.525</span>, <span class="dv">1</span>), <span class="at">more=</span>T)</span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gphB, <span class="at">position=</span><span class="fu">c</span>(<span class="fl">0.52</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">par.settings=</span>DAAG<span class="sc">::</span><span class="fu">DAAGtheme</span>(<span class="at">color=</span>T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="different-statistics-give-different-perspectives" class="level5">
<h5 class="anchored" data-anchor-id="different-statistics-give-different-perspectives">Different statistics give different perspectives</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttest.tstat</span>(<span class="fu">qt</span>(<span class="fl">0.00001</span>, <span class="at">df=</span><span class="dv">40</span>), <span class="at">n1=</span><span class="dv">40</span>, <span class="at">simple=</span>T)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttest.tstat</span>(<span class="fu">qt</span>(<span class="fl">0.000001</span>, <span class="at">df=</span><span class="dv">40</span>), <span class="at">n1=</span><span class="dv">40</span>, <span class="at">simple=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>bf1 <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttest.tstat</span>(<span class="fu">qt</span>(<span class="fl">0.00001</span>, <span class="at">df=</span><span class="dv">40</span>), <span class="at">n1=</span><span class="dv">40</span>, <span class="at">simple=</span>T)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>bf2 <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttest.tstat</span>(<span class="fu">qt</span>(<span class="fl">0.000001</span>, <span class="at">df=</span><span class="dv">40</span>), <span class="at">n1=</span><span class="dv">40</span>, <span class="at">simple=</span>T)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="st">"Bayes Factors"</span><span class="ot">=</span><span class="fu">setNames</span>(<span class="fu">c</span>(bf1,bf2), <span class="fu">c</span>(<span class="st">"p=0.00001"</span>,<span class="st">"p=0.000001"</span>)),</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"t-statistics"</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">qt</span>(<span class="fl">0.00001</span>, <span class="at">df=</span><span class="dv">40</span>), <span class="fu">qt</span>(<span class="fl">0.000001</span>, <span class="at">df=</span><span class="dv">40</span>))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">"A bare mention"</span>,<span class="st">"Positive"</span>,<span class="st">"Strong"</span>,<span class="st">"Very strong"</span>), <span class="at">nrow=</span><span class="dv">1</span>),</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"1 -- 3"</span>, <span class="st">"3 -- 20"</span>, <span class="st">"20 -- 150"</span>, <span class="st">"&gt;150"</span>), <span class="at">align=</span><span class="st">'c'</span>,</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">midrule=</span><span class="st">''</span>, <span class="at">vline=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="technical-details-of-the-family-of-priors-used-in-the-bayesfactor-package" class="level5">
<h5 class="anchored" data-anchor-id="technical-details-of-the-family-of-priors-used-in-the-bayesfactor-package">*Technical details of the family of priors used in the BayesFactor package</h5>
</section>
</section>
</section>
<section id="section-1.8-resampling-methods-for-ses-tests-and-confidence-intervals" class="level3">
<h3 class="anchored" data-anchor-id="section-1.8-resampling-methods-for-ses-tests-and-confidence-intervals">Section 1.8: Resampling methods for SEs, tests and confidence intervals</h3>
<section id="subsection-1.8.1-the-one-sample-permutation-test" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.8.1-the-one-sample-permutation-test">Subsection 1.8.1: The one-sample permutation test</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(DAAG<span class="sc">::</span>pair65))</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(tab,<span class="st">"heated-ambient"</span><span class="ot">=</span>tab[<span class="dv">1</span>,]<span class="sc">-</span>tab[<span class="dv">2</span>,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="subsection-1.8.2-the-two-sample-permutation-test" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.8.2-the-two-sample-permutation-test">Subsection 1.8.2: The two-sample permutation test</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="do">## First of 3 curves; permutation distribution of difference in means</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>two65 <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>two65</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">47</span>)        <span class="co"># Repeat curves shown here</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">2000</span>; dsims <span class="ot">&lt;-</span> <span class="fu">numeric</span>(nsim)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">with</span>(two65, <span class="fu">c</span>(ambient, heated))</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x); n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(two65<span class="sc">$</span>heated)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>dbar <span class="ot">&lt;-</span> <span class="fu">with</span>(two65, <span class="fu">mean</span>(heated)<span class="sc">-</span><span class="fu">mean</span>(ambient))</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  mn <span class="ot">&lt;-</span> <span class="fu">sample</span>(n,n2,<span class="at">replace=</span><span class="cn">FALSE</span>); dsims[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[mn]) <span class="sc">-</span> <span class="fu">mean</span>(x[<span class="sc">-</span>mn]) }</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(dsims), <span class="at">xlab=</span><span class="st">""</span>, <span class="at">main=</span><span class="st">""</span>, <span class="at">lwd=</span><span class="fl">0.5</span>, <span class="at">yaxs=</span><span class="st">"i"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.08</span>), <span class="at">bty=</span><span class="st">"n"</span>)</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(dbar, <span class="sc">-</span>dbar), <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>pval1 <span class="ot">&lt;-</span> (<span class="fu">sum</span>(dsims <span class="sc">&gt;=</span> <span class="fu">abs</span>(dbar)) <span class="sc">+</span> <span class="fu">sum</span> (dsims <span class="sc">&lt;=</span> <span class="sc">-</span><span class="fu">abs</span>(dbar)))<span class="sc">/</span>nsim</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>,<span class="at">line=</span><span class="fl">0.25</span>,</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text=</span><span class="fu">expression</span>(<span class="fu">bar</span>(<span class="fu">italic</span>(x))[<span class="dv">2</span>]<span class="sc">-</span><span class="fu">bar</span>(<span class="fu">italic</span>(x))[<span class="dv">1</span>]), <span class="at">at=</span>dbar)</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side=</span><span class="dv">3</span>,<span class="at">line=</span><span class="fl">0.25</span>,</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">text=</span><span class="fu">expression</span>(<span class="sc">-</span>(<span class="fu">bar</span>(<span class="fu">italic</span>(x))[<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">bar</span>(<span class="fu">italic</span>(x))[<span class="dv">1</span>])), <span class="at">at=</span><span class="sc">-</span>dbar)</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Second permutation density</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>mn <span class="ot">&lt;-</span> <span class="fu">sample</span>(n,n2,<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>dsims[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[mn]) <span class="sc">-</span> <span class="fu">mean</span>(x[<span class="sc">-</span>mn])</span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>pval2 <span class="ot">&lt;-</span> (<span class="fu">sum</span>(dsims <span class="sc">&gt;=</span> <span class="fu">abs</span>(dbar)) <span class="sc">+</span> <span class="fu">sum</span> (dsims <span class="sc">&lt;=</span> <span class="sc">-</span><span class="fu">abs</span>(dbar)))<span class="sc">/</span>nsim</span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(dsims),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">1</span>)</span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Third permutation density</span></span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim){</span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>mn <span class="ot">&lt;-</span> <span class="fu">sample</span>(n,n2,<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a>dsims[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[mn]) <span class="sc">-</span> <span class="fu">mean</span>(x[<span class="sc">-</span>mn])</span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a>pval3 <span class="ot">&lt;-</span> (<span class="fu">sum</span>(dsims <span class="sc">&gt;=</span> <span class="fu">abs</span>(dbar)) <span class="sc">+</span> <span class="fu">sum</span> (dsims <span class="sc">&lt;=</span> <span class="sc">-</span><span class="fu">abs</span>(dbar)))<span class="sc">/</span>nsim</span>
<span id="cb101-30"><a href="#cb101-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(dsims),<span class="at">lty=</span><span class="dv">3</span>,<span class="at">lwd=</span><span class="fl">1.25</span>)</span>
<span id="cb101-31"><a href="#cb101-31" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>(<span class="at">col=</span><span class="st">"gray"</span>)</span>
<span id="cb101-32"><a href="#cb101-32" aria-hidden="true" tabindex="-1"></a>leg3 <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">c</span>(pval1,pval2,pval3))</span>
<span id="cb101-33"><a href="#cb101-33" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x=</span><span class="dv">20</span>, <span class="at">y=</span><span class="fl">0.078</span>, <span class="at">title=</span><span class="st">"P-values are"</span>, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">xpd=</span><span class="cn">TRUE</span>,</span>
<span id="cb101-34"><a href="#cb101-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">bty=</span><span class="st">"n"</span>, <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">1.25</span>), <span class="at">legend=</span>leg3, <span class="at">y.intersp=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="subsection-1.8.3-estimating-the-standard-error-of-the-median-bootstrapping" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.8.3-estimating-the-standard-error-of-the-median-bootstrapping">Subsection 1.8.3: Estimating the standard error of the median: bootstrapping</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Bootstrap estimate of median of wren length: data frame cuckoos</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>wren <span class="ot">&lt;-</span> <span class="fu">subset</span>(DAAG<span class="sc">::</span>cuckoos, species<span class="sc">==</span><span class="st">"wren"</span>)[, <span class="st">"length"</span>]</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="do">## First define median.fun(), with two required arguments:</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="do">##         data specifies the data vector,</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="do">##         indices selects vector elements for each resample</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>median.fun <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices){<span class="fu">median</span>(data[indices])}</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Call boot(), with statistic=median.fun, R = # of resamples</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">23</span>)</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>(wren.boot <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> wren, <span class="at">statistic =</span> median.fun, <span class="at">R =</span> <span class="dv">4999</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="subsection-1.8.4-bootstrap-estimates-of-confidence-intervals" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.8.4-bootstrap-estimates-of-confidence-intervals">Subsection 1.8.4: Bootstrap estimates of confidence intervals</h4>
<section id="bootstrap-95-confidence-intervals-for-the-median" class="level5">
<h5 class="anchored" data-anchor-id="bootstrap-95-confidence-intervals-for-the-median">Bootstrap 95% confidence intervals for the median</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Call the function boot.ci() , with boot.out=wren.boot</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(<span class="at">boot.out=</span>wren.boot, <span class="at">type=</span><span class="fu">c</span>(<span class="st">"perc"</span>,<span class="st">"bca"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-correlation-coefficient" class="level5">
<h5 class="anchored" data-anchor-id="the-correlation-coefficient">The correlation coefficient</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Bootstrap estimate of 95% CI for `cor(chest, belly)`: `DAAG::possum`</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>corr.fun <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(data, <span class="fu">cor</span>(belly[indices], chest[indices]))</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">29</span>)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>corr.boot <span class="ot">&lt;-</span> <span class="fu">boot</span>(DAAG<span class="sc">::</span>possum, corr.fun, <span class="at">R=</span><span class="dv">9999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(<span class="at">boot.out =</span> corr.boot, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"perc"</span>, <span class="st">"bca"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-bootstrap-parting-comments" class="level5">
<h5 class="anchored" data-anchor-id="the-bootstrap-parting-comments">The bootstrap – parting comments</h5>
</section>
</section>
</section>
<section id="section-1.9-organizing-and-managing-work-and-tools-that-can-assist" class="level3">
<h3 class="anchored" data-anchor-id="section-1.9-organizing-and-managing-work-and-tools-that-can-assist">Section 1.9: Organizing and managing work, and tools that can assist</h3>
<section id="the-rstudio-integrated-development-environment" class="level5">
<h5 class="anchored" data-anchor-id="the-rstudio-integrated-development-environment">The RStudio Integrated Development Environment</h5>
</section>
<section id="subsection-1.9.1-reproducible-reporting-the-knitr-package" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.9.1-reproducible-reporting-the-knitr-package">Subsection 1.9.1: Reproducible reporting — the knitr package</h4>
</section>
</section>
<section id="section-1.10-the-changing-environment-for-data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="section-1.10-the-changing-environment-for-data-analysis">Section 1.10: The changing environment for data analysis</h3>
<section id="subsection-1.10.1-models-and-machine-learning" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.10.1-models-and-machine-learning">Subsection 1.10.1: Models and machine learning</h4>
<section id="the-limits-of-current-machine-learning-systems" class="level5">
<h5 class="anchored" data-anchor-id="the-limits-of-current-machine-learning-systems">The limits of current machine learning systems</h5>
</section>
<section id="traps-in-big-data-analysis" class="level5">
<h5 class="anchored" data-anchor-id="traps-in-big-data-analysis">Traps in big data analysis</h5>
</section>
<section id="of-mice-and-machine-learning-missing-data-values" class="level5">
<h5 class="anchored" data-anchor-id="of-mice-and-machine-learning-missing-data-values">Of mice and machine learning — missing data values</h5>
</section>
<section id="humans-are-not-good-intuitive-statisticians" class="level5">
<h5 class="anchored" data-anchor-id="humans-are-not-good-intuitive-statisticians">Humans are not good intuitive statisticians</h5>
</section>
</section>
<section id="subsection-1.10.2-replicability-is-the-definitive-check" class="level4">
<h4 class="anchored" data-anchor-id="subsection-1.10.2-replicability-is-the-definitive-check">Subsection 1.10.2: Replicability is the definitive check</h4>
<section id="to-what-extent-is-published-work-replicable-what-is-the-evidence" class="level5">
<h5 class="anchored" data-anchor-id="to-what-extent-is-published-work-replicable-what-is-the-evidence">To what extent is published work replicable? What is the evidence?</h5>
</section>
<section id="some-major-replication-studies" class="level5">
<h5 class="anchored" data-anchor-id="some-major-replication-studies">Some major replication studies</h5>
</section>
<section id="replicability-in-pre-clinical-cancer-research" class="level5">
<h5 class="anchored" data-anchor-id="replicability-in-pre-clinical-cancer-research">Replicability in pre-clinical cancer research</h5>
</section>
<section id="studies-where-there-may-be-strong-social-influences" class="level5">
<h5 class="anchored" data-anchor-id="studies-where-there-may-be-strong-social-influences">Studies where there may be strong social influences</h5>
</section>
<section id="the-scientific-study-of-scientific-processes" class="level5">
<h5 class="anchored" data-anchor-id="the-scientific-study-of-scientific-processes">The scientific study of scientific processes</h5>
</section>
<section id="would-lowering-the-p-value-threshold-help" class="level5">
<h5 class="anchored" data-anchor-id="would-lowering-the-p-value-threshold-help">Would lowering the <span class="math inline">\(p\)</span>-value threshold help?</h5>
</section>
<section id="peer-review-at-the-study-planning-stage" class="level5">
<h5 class="anchored" data-anchor-id="peer-review-at-the-study-planning-stage">Peer review at the study planning stage</h5>
</section>
</section>
</section>
<section id="section-1.11-further-or-supplementary-reading" class="level3">
<h3 class="anchored" data-anchor-id="section-1.11-further-or-supplementary-reading">Section 1.11: Further, or supplementary, reading</h3>
</section>
<section id="exercises-1_12" class="level3">
<h3 class="anchored" data-anchor-id="exercises-1_12">Exercises (1_12)</h3>
<p>1.4</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>Animals <span class="ot">&lt;-</span> MASS<span class="sc">::</span>Animals</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>manyMals <span class="ot">&lt;-</span> <span class="fu">rbind</span>(Animals, <span class="fu">sqrt</span>(Animals), Animals<span class="sc">^</span><span class="fl">0.1</span>, <span class="fu">log</span>(Animals))</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>manyMals<span class="sc">$</span>transgp <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Untransformed"</span>, <span class="st">"Square root transform"</span>,</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Power transform, lambda=0.1"</span>, <span class="st">"log transform"</span>),</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">nrow</span>(Animals),<span class="dv">4</span>))</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>manyMals<span class="sc">$</span>transgp <span class="ot">&lt;-</span> <span class="fu">with</span>(manyMals, <span class="fu">factor</span>(transgp, <span class="at">levels=</span><span class="fu">unique</span>(transgp)))</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">xyplot</span>(brain<span class="sc">~</span>body<span class="sc">|</span>transgp, <span class="at">data=</span>manyMals,</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">scales=</span><span class="fu">list</span>(<span class="at">relation=</span><span class="st">'free'</span>), <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.5</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(Animals, <span class="fu">c</span>(<span class="fu">cor</span>(brain,body), <span class="fu">cor</span>(brain,body, <span class="at">method=</span><span class="st">"spearman"</span>)))</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(Animals, <span class="fu">c</span>(<span class="fu">cor</span>(<span class="fu">log</span>(brain),<span class="fu">log</span>(body)),</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="fu">log</span>(brain),<span class="fu">log</span>(body), <span class="at">method=</span><span class="st">"spearman"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.9</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>usableDF <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>cuckoohosts[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">8</span>),]</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>nr <span class="ot">&lt;-</span> <span class="fu">nrow</span>(usableDF)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(usableDF, {</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">c</span>(clength, hlength), <span class="fu">c</span>(cbreadth, hbreadth), <span class="at">col=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="fu">c</span>(nr,nr)))</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nr)<span class="fu">lines</span>(<span class="fu">c</span>(clength[i], hlength[i]), <span class="fu">c</span>(cbreadth[i], hbreadth[i]))</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(hlength, hbreadth, <span class="fu">abbreviate</span>(<span class="fu">rownames</span>(usableDF),<span class="dv">8</span>), <span class="at">pos=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>))</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.10</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Take a random sample of 100 values from the normal distribution</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean=</span><span class="dv">3</span>, <span class="at">sd=</span><span class="dv">5</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>(xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x))</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot, against `xbar`, the sum of squared deviations from `xbar`</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>lsfun <span class="ot">&lt;-</span> <span class="cf">function</span>(xbar) <span class="fu">apply</span>(<span class="fu">outer</span>(x, xbar, <span class="st">"-"</span>)<span class="sc">^</span><span class="dv">2</span>, <span class="dv">2</span>, sum)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(lsfun, <span class="at">from=</span>xbar<span class="fl">-0.01</span>, <span class="at">to=</span>xbar<span class="fl">+0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(avs, meds, <span class="at">horizontal=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.15</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="fl">78.3</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x); <span class="fu">var</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.16</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>nvals100 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>heavytail <span class="ot">&lt;-</span> <span class="fu">rt</span>(<span class="dv">100</span>, <span class="at">df =</span> <span class="dv">4</span>)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>veryheavytail <span class="ot">&lt;-</span> <span class="fu">rt</span>(<span class="dv">100</span>, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(nvals100, heavytail, veryheavytail, <span class="at">horizontal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.19</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>boxdists <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n=</span><span class="dv">1000</span>, <span class="at">times=</span><span class="dv">10</span>){</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">normal=</span><span class="fu">rnorm</span>(n<span class="sc">*</span>times), <span class="at">t=</span><span class="fu">rt</span>(n<span class="sc">*</span>times, <span class="dv">7</span>),</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  sampnum <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>times, <span class="fu">rep</span>(n,times)))</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  lattice<span class="sc">::</span><span class="fu">bwplot</span>(sampnum <span class="sc">~</span> normal<span class="sc">+</span>t, <span class="at">data=</span>df, <span class="at">outer=</span><span class="cn">TRUE</span>, <span class="at">xlab=</span><span class="st">""</span>, </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">horizontal=</span>T)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.20</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>form <span class="ot">&lt;-</span> <span class="er">~</span><span class="fu">rchisq</span>(<span class="dv">1000</span>,<span class="dv">1</span>)<span class="sc">^</span>a<span class="sc">+</span><span class="fu">rchisq</span>(<span class="dv">1000</span>,<span class="dv">25</span>)<span class="sc">^</span>a<span class="sc">+</span><span class="fu">rchisq</span>(<span class="dv">1000</span>,<span class="dv">500</span>)<span class="sc">^</span>a</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">qqmath</span>(form, <span class="at">scales=</span><span class="fu">list</span>(<span class="at">relation=</span><span class="st">"free"</span>), <span class="at">outer=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.21</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">51</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>ydep <span class="ot">&lt;-</span> y1[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">+</span> y1[<span class="sc">-</span><span class="dv">51</span>]</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(y)      <span class="co"># acf plots `autocorrelation function'(see Chapter 6)</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(ydep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.24</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>ptFun <span class="ot">&lt;-</span> <span class="cf">function</span>(x,N)<span class="fu">pt</span>(<span class="fu">sqrt</span>(N)<span class="sc">*</span><span class="fu">mean</span>(x)<span class="sc">/</span><span class="fu">sd</span>(x), <span class="at">df=</span>N<span class="dv">-1</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>simStat <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">eff=</span>.<span class="dv">4</span>, <span class="at">N=</span><span class="dv">10</span>, <span class="at">nrep=</span><span class="dv">200</span>, FUN)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">array</span>(<span class="fu">rnorm</span>(<span class="at">n=</span>N<span class="sc">*</span>nrep<span class="sc">*</span><span class="fu">length</span>(eff), <span class="at">mean=</span>eff), <span class="at">dim=</span><span class="fu">c</span>(<span class="fu">length</span>(eff),nrep,N)) <span class="sc">|&gt;</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">apply</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>, FUN, <span class="at">N=</span>N) </span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">simStat</span>(<span class="at">eff=</span>.<span class="dv">4</span>, <span class="at">N=</span><span class="dv">10</span>, <span class="at">nrep=</span><span class="dv">200</span>, <span class="at">FUN=</span>ptFun)</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Suggest a power transform that makes the distribution more symmetric</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">powerTransform</span>(pval)   <span class="co"># See Subsection 2.5.6</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>labx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.0001</span>, <span class="fl">0.001</span>, <span class="fl">0.005</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span>)</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(<span class="sc">~</span><span class="fu">I</span>(pval<span class="sc">^</span><span class="fl">0.2</span>), <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">at=</span>labx<span class="sc">^</span><span class="fl">0.2</span>, <span class="at">labels=</span><span class="fu">paste</span>(labx))),</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="fu">expression</span>(<span class="st">"P-value (scale is "</span><span class="sc">*</span>p<span class="sc">^</span>{<span class="fl">0.2</span>}<span class="sc">*</span><span class="st">")"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.24a</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>pvalDF <span class="ot">&lt;-</span> <span class="fu">subset</span>(df200, effsize<span class="sc">==</span><span class="fl">0.4</span> <span class="sc">&amp;</span> N<span class="sc">==</span><span class="dv">10</span>)<span class="sc">$</span>stat</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">sort</span>(pval<span class="sc">^</span><span class="fl">0.2</span>), <span class="fu">sort</span>(pvalDF<span class="sc">^</span><span class="fl">0.2</span>))</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.24c</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Estimated effect sizes: Set `FUN=effFun` in the call to `eff2stat()`</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>effFun <span class="ot">&lt;-</span> <span class="cf">function</span>(x,N)<span class="fu">mean</span>(x)<span class="sc">/</span><span class="fu">sd</span>(x)   </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Try: `labx &lt;- ((-1):6)/2`; `at = log(labx)`; `v = log(labx)  </span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="do">## NB also, Bayes Factors: Set `FUN=BFfun` in the call to `eff2stat()`</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>BFfun <span class="ot">&lt;-</span> <span class="cf">function</span>(x,N)BayesFactor<span class="sc">::</span><span class="fu">ttest.tstat</span>(<span class="fu">sqrt</span>(N)<span class="sc">*</span><span class="fu">mean</span>(x)<span class="sc">/</span><span class="fu">sd</span>(x),</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">n1=</span>N, <span class="at">simple=</span>T)</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># A few very large Bayes Factors are likely to dominate the plots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.27</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>(degC <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">30</span>,<span class="dv">38</span>,<span class="dv">46</span>),<span class="fu">paste</span>(<span class="st">'rep'</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.27a</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>radonC <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(MPV<span class="sc">::</span>radon, <span class="at">names_to=</span><span class="st">'key'</span>, </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">cols=</span><span class="fu">names</span>(degC), <span class="at">values_to=</span><span class="st">'percent'</span>)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>radonC<span class="sc">$</span>temp <span class="ot">&lt;-</span> degC[radonC<span class="sc">$</span>key]</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>lattice<span class="sc">::</span><span class="fu">xyplot</span>(percent <span class="sc">~</span> temp<span class="sc">|</span><span class="fu">factor</span>(diameter), <span class="at">data =</span> radonC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="fu">scale</span>(<span class="fu">t</span>(MPV<span class="sc">::</span>radon[,<span class="sc">-</span><span class="dv">1</span>])), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">ylab=</span><span class="st">"scaled residuals"</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.27d</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>radon.res <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(percent <span class="sc">~</span> diameter, <span class="at">data =</span> radonC, <span class="at">FUN =</span> scale, </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>1.30</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span>diamonds</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(diamonds, <span class="fu">plot</span>(carat, price, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">0.25</span>))</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(diamonds, <span class="fu">smoothScatter</span>(carat, price))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>t2bfInterval <span class="ot">&lt;-</span> <span class="cf">function</span>(t, <span class="at">n=</span><span class="dv">10</span>, <span class="at">rscale=</span><span class="st">"medium"</span>, <span class="at">mu=</span><span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">1</span>,.<span class="dv">1</span>)){</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>     null0 <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttest.tstat</span>(<span class="at">t=</span>t, <span class="at">n1=</span>n, <span class="at">nullInterval=</span>mu,</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">rscale=</span>rscale,<span class="at">simple=</span><span class="cn">TRUE</span>)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>alt0 <span class="ot">&lt;-</span> BayesFactor<span class="sc">::</span><span class="fu">ttest.tstat</span>(<span class="at">t=</span>t, <span class="at">n1=</span>n, <span class="at">nullInterval=</span>mu, <span class="at">rscale=</span>rscale, </span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">complement=</span><span class="cn">TRUE</span>, <span class="at">simple=</span><span class="cn">TRUE</span>)</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>alt0<span class="sc">/</span>null0</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>); nval <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">40</span>,<span class="dv">160</span>)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>bfDF <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">p=</span>pval, <span class="at">n=</span>nval)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>pcol <span class="ot">&lt;-</span> <span class="dv">1</span>; ncol <span class="ot">&lt;-</span> <span class="dv">2</span>; tcol <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>bfDF[,<span class="st">'t'</span>] <span class="ot">&lt;-</span> <span class="fu">apply</span>(bfDF,<span class="dv">1</span>,<span class="cf">function</span>(x){<span class="fu">qt</span>(x[pcol]<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>x[ncol]<span class="sc">-</span><span class="dv">1</span>,                                  <span class="at">lower.tail=</span><span class="cn">FALSE</span>)})</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>other <span class="ot">&lt;-</span> <span class="fu">apply</span>(bfDF,<span class="dv">1</span>,<span class="cf">function</span>(x)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(BayesFactor<span class="sc">::</span><span class="fu">ttest.tstat</span>(<span class="at">t=</span>x[tcol], <span class="at">n1=</span>x[ncol], <span class="at">rscale=</span><span class="st">"medium"</span>,</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">simple=</span><span class="cn">TRUE</span>),</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>      BayesFactor<span class="sc">::</span><span class="fu">ttest.tstat</span>(<span class="at">t=</span>x[tcol], <span class="at">n1=</span>x[ncol], <span class="at">rscale=</span><span class="st">"wide"</span>,</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">simple=</span><span class="cn">TRUE</span>),</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Now specify a null interval</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t2bfInterval</span>(<span class="at">t=</span>x[tcol], <span class="at">n=</span>x[ncol], <span class="at">mu=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>),<span class="at">rscale=</span><span class="st">"medium"</span>),</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">t2bfInterval</span>(<span class="at">t=</span>x[tcol], <span class="at">n=</span>x[ncol], <span class="at">mu=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>),<span class="at">rscale=</span><span class="st">"wide"</span>)</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>bfDF <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">cbind</span>(bfDF, <span class="fu">t</span>(other)),</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">'p'</span>,<span class="st">'n'</span>,<span class="st">'t'</span>,<span class="st">'bf'</span>,<span class="st">'bfInterval'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> <span class="fu">with</span>(datasets<span class="sc">::</span>sleep, extra[group<span class="sc">==</span><span class="dv">2</span>] <span class="sc">-</span> extra[group<span class="sc">==</span><span class="dv">1</span>]))</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statsr)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>BayesFactor<span class="sc">::</span><span class="fu">ttestBF</span>(df<span class="sc">$</span>d, <span class="at">rscale=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>))   <span class="co"># Or, `rscale="medium"`</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># `rscale="medium"` is the default</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="fu">bayes_inference</span>(d, <span class="at">type=</span><span class="st">'ht'</span>, <span class="at">data=</span>df, <span class="at">statistic=</span><span class="st">'mean'</span>, <span class="at">method=</span><span class="st">'t'</span>, <span class="at">rscale=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>),</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="st">'twosided'</span>, <span class="at">null=</span><span class="dv">0</span>, <span class="at">prior_family =</span> <span class="st">"JZS"</span>)</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set `rscale=1/sqrt(2)` (default is 1.0) </span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># as for BayesFactor; gives same BF</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare with `prior_family = "JUI"` (`"JZS"` is the default), </span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="co"># with (if not supplied) default settings</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="fu">bayes_inference</span>(d, <span class="at">type=</span><span class="st">'ht'</span>, <span class="at">data=</span>df, <span class="at">statistic=</span><span class="st">'mean'</span>, <span class="at">method=</span><span class="st">'t'</span>,</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="st">'twosided'</span>, <span class="at">null=</span><span class="dv">0</span>, <span class="at">prior_family =</span> <span class="st">"JUI"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">file.exists</span>(<span class="st">"/Users/johnm1/pkgs/PGRcode/inst/doc/"</span>)){</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>code <span class="ot">&lt;-</span> knitr<span class="sc">::</span>knit_code<span class="sc">$</span><span class="fu">get</span>()</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">## "</span>, <span class="fu">names</span>(code),<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">sapply</span>(code, paste, <span class="at">collapse=</span><span class="st">'</span><span class="sc">\n</span><span class="st">'</span>))</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(txt, <span class="at">con=</span><span class="st">"/Users/johnm1/pkgs/PGRcode/inst/doc/ch1.R"</span>)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<script src="https://giscus.app/client.js" data-repo="ten-z/PGRTestBook" data-repo-id="R_kgDOMEfiPg" data-category="Announcements" data-category-id="DIC_kwDOMEfiPs4Cf5L1" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="en" crossorigin="anonymous" async="">
</script>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="ten-z/PGRTestBook" data-repo-id="R_kgDOMEfiPg" data-category="General" data-category-id="DIC_kwDOMEfiPs4Cf5L2" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch2.html" class="pagination-link" aria-label="Chapter 2: Generalizing from models">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Chapter 2: Generalizing from models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>